!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("react-dom"),require("react")):"function"==typeof define&&define.amd?define(["exports","react-dom","react"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).WebApp={},e.ReactDOM,e.React)}(this,(function(e,t,n){"use strict";function r(e,t){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return setTimeout((function(){return e.apply(null,n)}),t)}function i(e){return e.replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"').replace(/&#x27;/g,"'").replace(/&#x60;/g,"`")}function o(e,t,n){var r,i,o,a;void 0===n&&(n={});var s=0,l=function(){s=!1===n.leading?0:Date.now(),r=null,a=e.apply(i,o),r||(i=o=null)};return function(){var c=Date.now();s||!1!==n.leading||(s=c);var u=t-(c-s);return i=this,o=arguments,u<=0||u>t?(r&&(clearTimeout(r),r=null),s=c,a=e.apply(i,o),r||(i=o=null)):r||!1===n.trailing||(r=setTimeout(l,u)),a}}function a(e,t){return{x:e.x-t.x,y:e.y-t.y}}var s=function(){function e(e,t){var n=this;this.onChange=t,this.offset={x:0,y:0},this.zoomLevel=0,this.superSampling=window.devicePixelRatio||1;var r=!1;var i=function(){r=!1,e.style.width="33%"};e.addEventListener("mousedown",(function(t){e.style.width="100%",r=a({x:t.pageX,y:t.pageY},n.offset)})),e.addEventListener("mouseup",i),e.addEventListener("mouseleave",i),e.addEventListener("wheel",o((function(e){n.zoomLevel=Math.min(10,n.zoomLevel-(e.deltaY<0?-1:1)),t()}),50),{passive:!0}),e.addEventListener("mousemove",o((function(e){0!=r&&(n.offset=a({x:e.pageX,y:e.pageY},r),t())}),50),{passive:!0})}return e.prototype.positionCanvas=function(e){var t=window,n=e.width/this.superSampling,r=e.height/this.superSampling;e.style.top=300*(1-r/t.innerHeight)+this.offset.y+"px",e.style.left=150+(t.innerWidth-n)/2+this.offset.x+"px",e.style.width=n+"px",e.style.height=r+"px"},e.prototype.zoom=function(){return this.superSampling*Math.exp(this.zoomLevel/10)},e.prototype.magnify=function(e){this.zoomLevel=Math.min(10,this.zoomLevel+e),this.onChange()},e.prototype.reset=function(){this.zoomLevel=1,this.offset={x:0,y:0},this.onChange()},e}(),l=function(){function e(e,t,n){this.editor=e,this.marker=t,this.lineNumbers=n}return e.prototype.clearState=function(){this.marker.style.top="-30px",this.lineNumbers.classList.remove("error")},e.prototype.setError=function(e){this.lineNumbers.classList.add("error");var t=e.message.match("line ([0-9]*)");if(!t)throw e;var n=window.getComputedStyle(this.editor).lineHeight,r=parseFloat(n)||12;this.marker.style.top=3+r*+t[1]+"px"},e}(),c="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function u(e,t,n){return e(n={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&n.path)}},n.exports),n.exports}function h(e){if(e.__esModule)return e;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(e).forEach((function(n){var r=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(t,n,r.get?r:{enumerable:!0,get:function(){return e[n]}})})),t}var d=u((function(e,t){!function(){function t(e,t){return void 0===t?t={autoBom:!1}:"object"!=typeof t&&(console.warn("Deprecated: Expected third argument to be a object"),t={autoBom:!t}),t.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(e.type)?new Blob(["\ufeff",e],{type:e.type}):e}function n(e,t,n){var r=new XMLHttpRequest;r.open("GET",e),r.responseType="blob",r.onload=function(){a(r.response,t,n)},r.onerror=function(){console.error("could not download file")},r.send()}function r(e){var t=new XMLHttpRequest;t.open("HEAD",e,!1);try{t.send()}catch(e){}return 200<=t.status&&299>=t.status}function i(e){try{e.dispatchEvent(new MouseEvent("click"))}catch(n){var t=document.createEvent("MouseEvents");t.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),e.dispatchEvent(t)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof c&&c.global===c?c:void 0,a=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype?function(e,t,a){var s=o.URL||o.webkitURL,l=document.createElement("a");t=t||e.name||"download",l.download=t,l.rel="noopener","string"==typeof e?(l.href=e,l.origin===location.origin?i(l):r(l.href)?n(e,t,a):i(l,l.target="_blank")):(l.href=s.createObjectURL(e),setTimeout((function(){s.revokeObjectURL(l.href)}),4e4),setTimeout((function(){i(l)}),0))}:"msSaveOrOpenBlob"in navigator?function(e,o,a){if(o=o||e.name||"download","string"!=typeof e)navigator.msSaveOrOpenBlob(t(e,a),o);else if(r(e))n(e,o,a);else{var s=document.createElement("a");s.href=e,s.target="_blank",setTimeout((function(){i(s)}))}}:function(e,t,r,i){if((i=i||open("","_blank"))&&(i.document.title=i.document.body.innerText="downloading..."),"string"==typeof e)return n(e,t,r);var a="application/octet-stream"===e.type,s=/constructor/i.test(o.HTMLElement)||o.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||a&&s)&&"object"==typeof FileReader){var c=new FileReader;c.onloadend=function(){var e=c.result;e=l?e:e.replace(/^data:[^;]*;/,"data:attachment/file;"),i?i.location.href=e:location=e,i=null},c.readAsDataURL(e)}else{var u=o.URL||o.webkitURL,h=u.createObjectURL(e);i?i.location=h:location.href=h,i=null,setTimeout((function(){u.revokeObjectURL(h)}),4e4)}});o.saveAs=a.saveAs=a,e.exports=a}()})),f=u((function(e,t){!function(e){class t{constructor(){var e={};e._next=e._prev=e,this._sentinel=e}dequeue(){var e=this._sentinel,t=e._prev;if(t!==e)return n(t),t}enqueue(e){var t=this._sentinel,r=e;r._prev&&r._next&&n(r),r._next=t._next,t._next._prev=r,t._next=r,r._prev=t}toString(){for(var e=[],t=this._sentinel,n=t._prev;n!==t;)e.push(JSON.stringify(n,r)),n=n._prev;return"["+e.join(", ")+"]"}}function n(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function r(e,t){if("_next"!==e&&"_prev"!==e)return t}var i=Object.freeze({__proto__:null,List:t});const o={};function a(e){var t=[];for(var n of e)t.push(...n);return t}function s(e,t){return null!=e&&e.hasOwnProperty(t)}function l(e){const t=null==e?0:e.length;return t?e[t-1]:void 0}function c(e,t){e=Object(e);const n={};return Object.keys(e).forEach((r=>{n[r]=t(e[r],r)})),n}function u(e,t){var n=Number.POSITIVE_INFINITY,r=void 0;for(var i of e){var o=t(i);o<n&&(n=o,r=i)}return r}function h(e,t){var n=e<t?1:-1;let r=-1,i=Math.max(Math.ceil((t-e)/(n||1)),0);const o=new Array(i);for(;i--;)o[++r]=e,e+=n;return o}function d(e,t){return e.slice().sort(((e,n)=>t(e)-t(n)))}function f(e){return o[e]||(o[e]=0),`${e}${++o[e]}`}function p(e){return e?Object.keys(e).map((t=>e[t])):[]}function v(e,t){for(var n=[],r=0;r<e;r++)n.push(t());return n}function g(e){return void 0===e}function m(e,t){for(var n of Object.keys(e))t(e[n],n)}function y(e){return 0===Object.keys(e).length}function w(e){var t={},n=e.nodes().filter((t=>!e.children(t).length)),r=v(Math.max(...n.map((t=>e.node(t).rank)))+1,(()=>[]));return d(n,(t=>e.node(t).rank)).forEach((function n(i){if(!s(t,i)){t[i]=!0;var o=e.node(i);r[o.rank].push(i),e.successors(i).forEach(n)}})),r}function b(e,t){for(var n=0,r=1;r<t.length;++r)n+=x(e,t[r-1],t[r]);return n}function x(e,t,n){for(var r={},i=0;i<n.length;i++)r[n[i]]=i;for(var o=a(t.map((function(t){return d(e.outEdges(t).map((function(t){return{pos:r[t.w],weight:e.edge(t).weight}})),(e=>e.pos))}))),s=1;s<n.length;)s<<=1;var l=2*s-1;s-=1;var c=v(l,(()=>0)),u=0;return o.forEach((function(e){var t=e.pos+s;c[t]+=e.weight;for(var n=0;t>0;)t%2&&(n+=c[t+1]),c[t=t-1>>1]+=e.weight;u+=e.weight*n})),u}function k(e,t){return t?t.map((function(t){var n=e.inEdges(t);if(n.length){var r=n.reduce((function(t,n){var r=e.edge(n),i=e.node(n.v);return{sum:t.sum+r.weight*i.order,weight:t.weight+r.weight}}),{sum:0,weight:0});return{v:t,barycenter:r.sum/r.weight,weight:r.weight}}return{v:t}})):[]}function _(e,t){for(var n={},r=0;r<e.length;r++){var i=e[r],o=n[i.v]={indegree:0,in:[],out:[],vs:[i.v],i:r};void 0!==i.barycenter&&(o.barycenter=i.barycenter,o.weight=i.weight)}for(var a of t.edges()){var s=n[a.v],l=n[a.w];void 0!==s&&void 0!==l&&(l.indegree++,s.out.push(n[a.w]))}return function(e){var t=[];function n(e){return function(t){t.merged||(void 0===t.barycenter||void 0===e.barycenter||t.barycenter>=e.barycenter)&&function(e,t){var n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}(e,t)}}function r(t){return function(n){n.in.push(t),0==--n.indegree&&e.push(n)}}for(;e.length;){var i=e.pop();t.push(i),i.in.reverse().forEach(n(i)),i.out.forEach(r(i))}return t.filter((e=>!e.merged)).map((function(e){var t={vs:e.vs,i:e.i};return"barycenter"in e&&(t.barycenter=e.barycenter),"weight"in e&&(t.weight=e.weight),t}))}(p(n).filter((e=>!e.indegree)))}var E="\0";class S{constructor(e={}){this._label=void 0,this._nodeCount=0,this._edgeCount=0,this._isDirected=!s(e,"directed")||e.directed,this._isMultigraph=!!s(e,"multigraph")&&e.multigraph,this._isCompound=!!s(e,"compound")&&e.compound,this._defaultNodeLabelFn=()=>{},this._defaultEdgeLabelFn=()=>{},this._nodes={},this._isCompound&&(this._parent={},this._children={},this._children["\0"]={}),this._in={},this._preds={},this._out={},this._sucs={},this._edgeObjs={},this._edgeLabels={}}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(e){return this._label=e,this}graph(){return this._label}setDefaultNodeLabel(e){var t;return t=e,this._defaultNodeLabelFn="function"!=typeof t?()=>e:e,this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var e=this;return this.nodes().filter((function(t){return y(e._in[t])}))}sinks(){var e=this;return this.nodes().filter((t=>y(e._out[t])))}setNodes(e,t){for(var n of e)void 0!==t?this.setNode(n,t):this.setNode(n);return this}setNode(e,t){return s(this._nodes,e)?(arguments.length>1&&(this._nodes[e]=t),this):(this._nodes[e]=arguments.length>1?t:this._defaultNodeLabelFn(e),this._isCompound&&(this._parent[e]=E,this._children[e]={},this._children["\0"][e]=!0),this._in[e]={},this._preds[e]={},this._out[e]={},this._sucs[e]={},++this._nodeCount,this)}node(e){return this._nodes[e]}hasNode(e){return s(this._nodes,e)}removeNode(e){var t=this;if(s(this._nodes,e)){var n=e=>{t.removeEdge(this._edgeObjs[e])};if(delete this._nodes[e],this._isCompound){for(var r of(this._removeFromParentsChildList(e),delete this._parent[e],this.children(e)))t.setParent(r);delete this._children[e]}for(var i of Object.keys(this._in[e]))n(i);for(var i of(delete this._in[e],delete this._preds[e],Object.keys(this._out[e])))n(i);delete this._out[e],delete this._sucs[e],--this._nodeCount}return this}setParent(e,t){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(void 0===t)t=E;else{for(var n=t+="";!g(n);n=this.parent(n))if(n===e)throw new Error(`Setting ${t} as parent of ${e} would create a cycle`);this.setNode(t)}return this.setNode(e),this._removeFromParentsChildList(e),this._parent[e]=t,this._children[t][e]=!0,this}_removeFromParentsChildList(e){delete this._children[this._parent[e]][e]}parent(e){if(this._isCompound){var t=this._parent[e];if(t!==E)return t}}children(e){if(g(e)&&(e=E),this._isCompound){var t=this._children[e];return t?Object.keys(t):void 0}return e===E?this.nodes():this.hasNode(e)?[]:void 0}predecessors(e){var t=this._preds[e];if(t)return Object.keys(t)}successors(e){var t=this._sucs[e];if(t)return Object.keys(t)}neighbors(e){var t=this.predecessors(e);if(t)return function(e,t){var n=[...e];for(var r of t)-1===n.indexOf(r)&&n.push(r);return n}(t,this.successors(e))}isLeaf(e){return 0===(this.isDirected()?this.successors(e):this.neighbors(e)).length}filterNodes(e){var t=new S({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});t.setGraph(this.graph());var n=this;m(this._nodes,(function(n,r){e(r)&&t.setNode(r,n)})),m(this._edgeObjs,(function(e){t.hasNode(e.v)&&t.hasNode(e.w)&&t.setEdge(e,n.edge(e))}));var r={};function i(e){var o=n.parent(e);return void 0===o||t.hasNode(o)?(r[e]=o,o):o in r?r[o]:i(o)}if(this._isCompound)for(var o of t.nodes())t.setParent(o,i(o));return t}setDefaultEdgeLabel(e){var t;return t=e,this._defaultEdgeLabelFn="function"!=typeof t?()=>e:e,this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(e,t){var n=this,r=arguments;return e.reduce((function(e,i){return r.length>1?n.setEdge(e,i,t):n.setEdge(e,i),i})),this}setEdge(e,t,n,r){var i=!1,o=e;"object"==typeof o&&null!==o&&"v"in o?(e=o.v,t=o.w,r=o.name,2===arguments.length&&(n=arguments[1],i=!0)):(e=o,t=arguments[1],r=arguments[3],arguments.length>2&&(n=arguments[2],i=!0)),e=""+e,t=""+t,g(r)||(r=""+r);var a=z(this._isDirected,e,t,r);if(s(this._edgeLabels,a))return i&&(this._edgeLabels[a]=n),this;if(!g(r)&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(e),this.setNode(t),this._edgeLabels[a]=i?n:this._defaultEdgeLabelFn(e,t,r);var l=function(e,t,n,r){var i=""+t,o=""+n;if(!e&&i>o){var a=i;i=o,o=a}var s={v:i,w:o};return r&&(s.name=r),s}(this._isDirected,e,t,r);return e=l.v,t=l.w,Object.freeze(l),this._edgeObjs[a]=l,N(this._preds[t],e),N(this._sucs[e],t),this._in[t][a]=l,this._out[e][a]=l,this._edgeCount++,this}edge(e,t,n){var r="object"==typeof e?T(this._isDirected,e):z(this._isDirected,e,t,n);return this._edgeLabels[r]}hasEdge(e,t,n){var r=1===arguments.length?T(this._isDirected,arguments[0]):z(this._isDirected,e,t,n);return s(this._edgeLabels,r)}removeEdge(e,t,n){var r="object"==typeof e?T(this._isDirected,e):z(this._isDirected,e,t,n),i=this._edgeObjs[r];return i&&(e=i.v,t=i.w,delete this._edgeLabels[r],delete this._edgeObjs[r],L(this._preds[t],e),L(this._sucs[e],t),delete this._in[t][r],delete this._out[e][r],this._edgeCount--),this}inEdges(e,t){var n=this._in[e];if(n){var r=Object.values(n);return t?r.filter((function(e){return e.v===t})):r}}outEdges(e,t){var n=this._out[e];if(n){var r=Object.values(n);return t?r.filter((function(e){return e.w===t})):r}}nodeEdges(e,t){var n=this.inEdges(e,t);if(n)return n.concat(this.outEdges(e,t))}}class M extends S{}function N(e,t){e[t]?e[t]++:e[t]=1}function L(e,t){--e[t]||delete e[t]}function z(e,t,n,r){var i=""+t,o=""+n;if(!e&&i>o){var a=i;i=o,o=a}return i+""+o+""+(g(r)?"\0":r)}function T(e,t){return z(e,t.v,t.w,t.name)}function C(e,t,n,r){var i;do{i=f(r)}while(e.hasNode(i));return n.dummy=t,e.setNode(i,n),i}function I(e){var t=(new S).setGraph(e.graph());for(var n of e.nodes())t.setNode(n,e.node(n));for(var r of e.edges()){var i=t.edge(r.v,r.w)||{weight:0,minlen:1},o=e.edge(r);t.setEdge(r.v,r.w,{weight:i.weight+o.weight,minlen:Math.max(i.minlen,o.minlen)})}return t}function O(e){var t=new S({multigraph:e.isMultigraph()}).setGraph(e.graph());for(var n of e.nodes())e.children(n).length||t.setNode(n,e.node(n));for(var r of e.edges())t.setEdge(r,e.edge(r));return t}function A(e,t){var n,r,i=e.x,o=e.y,a=t.x-i,s=t.y-o,l=e.width/2,c=e.height/2;if(!a&&!s)throw new Error("Not possible to find intersection inside of the rectangle");return Math.abs(s)*l>Math.abs(a)*c?(s<0&&(c=-c),n=c*a/s,r=c):(a<0&&(l=-l),n=l,r=l*s/a),{x:i+n,y:o+r}}function j(e){var t=v(F(e)+1,(()=>[]));for(var n of e.nodes()){var r=e.node(n),i=r.rank;void 0!==i&&(t[i][r.order]=n)}return t}function P(e){var t=Math.min(...e.nodes().map((t=>e.node(t).rank)).filter((e=>void 0!==e)));for(var n of e.nodes()){var r=e.node(n);s(r,"rank")&&(r.rank-=t)}}function R(e){var t=Math.min(...e.nodes().map((t=>e.node(t).rank)).filter((e=>void 0!==e))),n=[];for(var r of e.nodes()){var i=e.node(r).rank-t;n[i]||(n[i]=[]),n[i].push(r)}for(var o=0,a=e.graph().nodeRankFactor,s=0;s<n.length;s++){var l=n[s];if(void 0===l&&s%a!=0)--o;else if(o&&null!=l)for(var r of l)e.node(r).rank+=o}}function D(e,t,n,r){var i={width:0,height:0};return arguments.length>=4&&(i.rank=n,i.order=r),C(e,"border",i,t)}function F(e){var t=e.nodes().map((t=>e.node(t).rank)).filter((e=>void 0!==e));return Math.max(...t)}function B(e,t){var n=[],r=[];for(var i of e)t(i)?n.push(i):r.push(i);return{lhs:n,rhs:r}}function q(e,t){var n=Date.now();try{return t()}finally{console.log(e+" time: "+(Date.now()-n)+"ms")}}function V(e,t){return t()}var G=Object.freeze({__proto__:null,addDummyNode:C,simplify:I,asNonCompoundGraph:O,successorWeights:function(e){var t={};for(var n of e.nodes()){var r={};for(var i of e.outEdges(n))r[i.w]=(r[i.w]||0)+e.edge(i).weight;t[n]=r}return t},predecessorWeights:function(e){var t={};for(var n of e.nodes()){var r={};for(var i of e.inEdges(n))r[i.v]=(r[i.v]||0)+e.edge(i).weight;t[n]=r}return t},intersectRect:A,buildLayerMatrix:j,normalizeRanks:P,removeEmptyRanks:R,addBorderNode:D,maxRank:F,partition:B,time:q,notime:V});function H(e,t){var n,r=B(e,(function(e){return s(e,"barycenter")})),i=r.lhs,o=d(r.rhs,(e=>-e.i)),l=[],c=0,u=0,h=0;for(var f of(i.sort((n=!!t,function(e,t){return e.barycenter<t.barycenter?-1:e.barycenter>t.barycenter?1:n?t.i-e.i:e.i-t.i})),h=W(l,o,h),i))h+=f.vs.length,l.push(f.vs),c+=f.barycenter*f.weight,u+=f.weight,h=W(l,o,h);var p={vs:a(l)};return u&&(p.barycenter=c/u,p.weight=u),p}function W(e,t,n){for(var r;t.length&&(r=l(t)).i<=n;)t.pop(),e.push(r.vs),n++;return n}function $(e,t,n,r){var i=e.children(t),o=e.node(t),l=o?o.borderLeft:void 0,c=o?o.borderRight:void 0,u={};l&&(i=i.filter((e=>e!==l&&e!==c)));var h=k(e,i);for(var d of h)if(e.children(d.v).length){var f=$(e,d.v,n,r);u[d.v]=f,s(f,"barycenter")&&U(d,f)}var p=_(h,n);!function(e,t){for(var n of e)n.vs=a(n.vs.map((function(e){return t[e]?t[e].vs:[e]})))}(p,u);var v=H(p,r);if(l&&(v.vs=[l,...v.vs,c],e.predecessors(l).length)){var g=e.node(e.predecessors(l)[0]),m=e.node(e.predecessors(c)[0]);s(v,"barycenter")||(v.barycenter=0,v.weight=0),v.barycenter=(v.barycenter*v.weight+g.order+m.order)/(v.weight+2),v.weight+=2}return v}function U(e,t){void 0!==e.barycenter?(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight):(e.barycenter=t.barycenter,e.weight=t.weight)}function Y(e,t,n){var r=function(e){for(var t;e.hasNode(t=f("_root")););return t}(e),i=new S({compound:!0}).setGraph({root:r}).setDefaultNodeLabel((t=>e.node(t)));for(var o of e.nodes()){var a=e.node(o),l=e.parent(o);if(a.rank===t||a.minRank<=t&&t<=a.maxRank){for(var c of(i.setNode(o),i.setParent(o,l||r),e[n](o))){var u=c.v===o?c.w:c.v,h=i.edge(u,o),d=void 0!==h?h.weight:0;i.setEdge(u,o,{weight:e.edge(c).weight+d})}s(a,"minRank")&&i.setNode(o,{borderLeft:a.borderLeft[t],borderRight:a.borderRight[t]})}}return i}function J(e,t,n){var r,i={};for(var o of n)!function(){for(var n,a=e.parent(o);a;){var s=e.parent(a);if(s?(n=i[s],i[s]=a):(n=r,r=a),n&&n!==a)return void t.setEdge(n,a);a=s}}()}function Q(e){var t=F(e),n=X(e,h(1,t+1),"inEdges"),r=X(e,h(t-1,-1),"outEdges"),i=w(e);K(e,i);for(var o,a=Number.POSITIVE_INFINITY,s=0,l=0;l<4;++s,++l){Z(s%2?n:r,s%4>=2);var c=b(e,i=j(e));c<a&&(l=0,o=i.map((e=>e.slice(0))),a=c)}K(e,o)}function X(e,t,n){return t.map((t=>Y(e,t,n)))}function Z(e,t){var n=new S;for(var r of e){var i=r.graph().root,o=$(r,i,n,t);o.vs.map((function(e,t){r.node(e).order=t})),J(r,n,o.vs)}}function K(e,t){for(var n of t)n.map((function(t,n){e.node(t).order=n}))}var ee=Object.freeze({__proto__:null,order:Q,addSubgraphConstraints:J,barycenter:k,buildLayerGraph:Y,crossCount:b,initOrder:w,resolveConflicts:_,sortSubgraph:$,sort:H});function te(e,t){var n={};return t.reduce((function(t,r){for(var i=0,o=0,a=t.length,s=l(r),c=0;c<r.length;c++){var u=r[c],h=re(e,u),d=h?e.node(h).order:a;if(h||u===s){for(var f of r.slice(o,c+1))for(var p of e.predecessors(f)){var v=e.node(p),g=v.order;!(g<i||d<g)||v.dummy&&e.node(f).dummy||ie(n,p,f)}o=c+1,i=d}}return r})),n}function ne(e,t){var n={};function r(t,r,i,o,a){var s;for(var l of h(r,i))if(s=t[l],e.node(s).dummy)for(var c of e.predecessors(s)){var u=e.node(c);u.dummy&&(u.order<o||u.order>a)&&ie(n,c,s)}}return t.reduce((function(t,n){for(var i,o=-1,a=0,s=0;s<n.length;s++){var l=s,c=n[s];if(void 0!==c){if("border"===e.node(c).dummy){var u=e.predecessors(c);u.length&&(r(n,a,l,o,i=e.node(u[0]).order),a=l,o=i)}r(n,a,n.length,i,t.length)}}return n})),n}function re(e,t){if(e.node(t).dummy)for(var n of e.predecessors(t))if(e.node(n).dummy)return n}function ie(e,t,n){if(t>n){var r=t;t=n,n=r}var i=e[t];i||(e[t]=i={}),i[n]=!0}function oe(e,t,n){if(t>n){var r=t;t=n,n=r}return s(e[t],n)}function ae(e,t,n,r){var i={},o={},a={};for(var s of t)for(var l=0;l<s.length;l++)i[u=s[l]]=u,o[u]=u,a[u]=l;for(var s of t){var c=-1;for(var u of s){var h=r(u);if(h.length)for(var f=((h=d(h,(e=>a[e]))).length-1)/2,p=Math.floor(f),v=Math.ceil(f);p<=v;++p){var g=h[p];o[u]===u&&c<a[g]&&!oe(n,u,g)&&(o[g]=u,o[u]=i[u]=i[g],c=a[g])}}}return{root:i,align:o}}function se(e,t,n,r,i){var o={},a=function(e,t,n,r){var i=new S,o=e.graph(),a=de(o.nodesep,o.edgesep,r);for(var s of t){var l=null;for(var c of s){var u=n[c];if(i.setNode(u),l){var h=n[l],d=i.edge(h,u);i.setEdge(h,u,Math.max(a(e,c,l),d||0))}l=c}}return i}(e,t,n,i),s=i?"borderLeft":"borderRight";function l(e,t){for(var n=a.nodes(),r=n.pop(),i={};r;)i[r]?e(r):(i[r]=!0,n.push(r),n=n.concat(t(r))),r=n.pop()}for(var c of(l((function(e){o[e]=a.inEdges(e).reduce((function(e,t){return Math.max(e,o[t.v]+a.edge(t))}),0)}),(e=>a.predecessors(e))),l((function(t){var n=a.outEdges(t).reduce((function(e,t){return Math.min(e,o[t.w]-a.edge(t))}),Number.POSITIVE_INFINITY),r=e.node(t);n!==Number.POSITIVE_INFINITY&&r.borderType!==s&&(o[t]=Math.max(o[t],n))}),(e=>a.successors(e))),Object.keys(r))){var u=r[c];o[u]=o[n[u]]}return o}function le(e,t){return u(p(t),(function(t){var n=Number.NEGATIVE_INFINITY,r=Number.POSITIVE_INFINITY;for(var i in t){var o=t[i],a=fe(e,i)/2;n=Math.max(o+a,n),r=Math.min(o-a,r)}return n-r}))}function ce(e,t){var n=p(t),r=Math.min(...n),i=Math.max(...n);for(var o of["ul","ur","dl","dr"]){var a=o[1],s=e[o];if(s!==t){var l=p(s),u="l"===a?r-Math.min(...l):i-Math.max(...l);u&&(e[o]=c(s,(e=>e+u)))}}}function ue(e,t){return c(e.ul,(function(n,r){if(t)return e[t.toLowerCase()][r];var i=d([e.ul[r],e.ur[r],e.dl[r],e.dr[r]],(e=>e));return(i[1]+i[2])/2}))}function he(e){var t,n=j(e),r=Object.assign(Object.assign({},te(e,n)),ne(e,n)),i={ul:{},ur:{},dl:{},dr:{}};for(var o of["u","d"])for(var a of(t="u"===o?n:n.map((e=>e)).reverse(),["l","r"])){"r"===a&&(t=t.map((e=>e.map((e=>e)).reverse())));var s=ae(0,t,r,("u"===o?e.predecessors:e.successors).bind(e)),l=se(e,t,s.root,s.align,"r"===a);"r"===a&&(l=c(l,(e=>-e))),i[o+a]=l}return ce(i,le(e,i)),ue(i,e.graph().align)}function de(e,t,n){return function(r,i,o){var a,l=r.node(i),c=r.node(o),u=0;if(u+=l.width/2,s(l,"labelpos"))switch(l.labelpos.toLowerCase()){case"l":a=-l.width/2;break;case"r":a=l.width/2}if(a&&(u+=n?a:-a),a=0,u+=(l.dummy?t:e)/2,u+=(c.dummy?t:e)/2,u+=c.width/2,s(c,"labelpos"))switch(c.labelpos.toLowerCase()){case"l":a=c.width/2;break;case"r":a=-c.width/2}return a&&(u+=n?a:-a),a=0,u}}function fe(e,t){return e.node(t).width}var pe=Object.freeze({__proto__:null,findType1Conflicts:te,findType2Conflicts:ne,findOtherInnerSegmentNode:re,addConflict:ie,hasConflict:oe,verticalAlignment:ae,horizontalCompaction:se,findSmallestWidthAlignment:le,alignCoordinates:ce,balance:ue,positionX:he,sep:de,width:fe});function ve(e){!function(e){var t=j(e),n=e.graph().ranksep,r=0;for(var i of t){var o=Math.max(...i.map((t=>e.node(t).height)));for(var a of i)e.node(a).y=r+o/2;r+=o+n}}(e=O(e));var t=he(e);for(var n in t)e.node(n).x=t[n]}var ge=Object.freeze({__proto__:null,bk:pe,position:ve});function me(e){var t={};e.sources().forEach((function n(r){var i=e.node(r);if(s(t,r))return i.rank;t[r]=!0;var o=Math.min(...e.outEdges(r).map((t=>n(t.w)-e.edge(t).minlen)));return o!==Number.POSITIVE_INFINITY&&null!=o||(o=0),i.rank=o}))}function ye(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}function we(e){var t,n=new S({directed:!1}),r=e.nodes()[0],i=e.nodeCount();for(n.setNode(r,{});o(e)<i;)t=a(e),s(e,n.hasNode(t.v)?ye(e,t):-ye(e,t));return n;function o(e){return n.nodes().forEach((function t(r){for(var i of e.nodeEdges(r)){var o=i.v,a=r===o?i.w:o;n.hasNode(a)||ye(e,i)||(n.setNode(a,{}),n.setEdge(r,a,{}),t(a))}})),n.nodeCount()}function a(e){return u(e.edges(),(function(t){if(n.hasNode(t.v)!==n.hasNode(t.w))return ye(e,t)}))}function s(e,t){for(var r of n.nodes())e.node(r).rank+=t}}class be{constructor(){this._arr=[],this._keyIndices={}}size(){return this._arr.length}keys(){return this._arr.map((function(e){return e.key}))}has(e){return e in this._keyIndices}priority(e){var t=this._keyIndices[e];if(void 0!==t)return this._arr[t].priority}min(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key}add(e,t){var n=this._keyIndices;if(!((e=String(e))in n)){var r=this._arr,i=r.length;return n[e]=i,r.push({key:e,priority:t}),this._decrease(i),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key}decrease(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)}_heapify(e){var t=this._arr,n=2*e,r=n+1,i=e;n<t.length&&(i=t[n].priority<t[i].priority?n:i,r<t.length&&(i=t[r].priority<t[i].priority?r:i),i!==e&&(this._swap(e,i),this._heapify(i)))}_decrease(e){for(var t,n=this._arr,r=n[e].priority;0!==e&&!(n[t=e>>1].priority<r);)this._swap(e,t),e=t}_swap(e,t){var n=this._arr,r=this._keyIndices,i=n[e],o=n[t];n[e]=o,n[t]=i,r[o.key]=e,r[i.key]=t}}var xe=()=>1;function ke(e,t,n,r){return function(e,t,n,r){var i,o,a={},s=new be,l=function(e){var t=e.v!==i?e.v:e.w,r=a[t],l=n(e),c=o.distance+l;if(l<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+e+" Weight: "+l);c<r.distance&&(r.distance=c,r.predecessor=i,s.decrease(t,c))};for(e.nodes().forEach((function(e){var n=e===t?0:Number.POSITIVE_INFINITY;a[e]={distance:n},s.add(e,n)}));s.size()>0&&(i=s.removeMin(),(o=a[i]).distance!==Number.POSITIVE_INFINITY);)r(i).forEach(l);return a}(e,String(t),n||xe,r||function(t){return e.outEdges(t)})}function _e(e){var t=0,n=[],r={},i=[];function o(a){var s=r[a]={onStack:!0,lowlink:t,index:t++};if(n.push(a),e.successors(a).forEach((function(e){e in r?r[e].onStack&&(s.lowlink=Math.min(s.lowlink,r[e].index)):(o(e),s.lowlink=Math.min(s.lowlink,r[e].lowlink))})),s.lowlink===s.index){var l,c=[];do{l=n.pop(),r[l].onStack=!1,c.push(l)}while(a!==l);i.push(c)}}return e.nodes().forEach((function(e){e in r||o(e)})),i}var Ee=()=>1;class Se extends Error{}function Me(e){var t={},n={},r=[];function i(o){if(o in n)throw new Se;if(!(o in t)){for(var a of(n[o]=!0,t[o]=!0,e.predecessors(o)))i(a);delete n[o],r.push(o)}}for(var o of e.sinks())i(o);if(Object.keys(t).length!==e.nodeCount())throw new Se;return r}function Ne(e,t,n){var r=Array.isArray(t)?t:[t],i=(e.isDirected()?e.successors:e.neighbors).bind(e),o=[],a={};for(var s of r){if(!e.hasNode(s))throw new Error("Graph does not have node: "+s);Le(e,s,"post"===n,a,i,o)}return o}function Le(e,t,n,r,i,o){if(!(t in r)){for(var a of(r[t]=!0,n||o.push(t),i(t)))Le(e,a,n,r,i,o);n&&o.push(t)}}function ze(e,t){return Ne(e,t,"post")}function Te(e,t){return Ne(e,t,"pre")}var Ce=Object.freeze({__proto__:null,components:function(e){var t,n={},r=[];function i(r){if(!(r in n)){for(var o of(n[r]=!0,t.push(r),e.successors(r)))i(o);for(var a of e.predecessors(r))i(a)}}for(var o of e.nodes())t=[],i(o),t.length&&r.push(t);return r},dijkstra:ke,dijkstraAll:function(e,t,n){var r={};for(var i of e.nodes())r[i]=ke(e,i,t,n);return r},findCycles:function(e){return _e(e).filter((function(t){return t.length>1||1===t.length&&e.hasEdge(t[0],t[0])}))},floydWarshall:function(e,t,n){return function(e,t,n){var r={},i=e.nodes();return i.forEach((function(e){r[e]={},r[e][e]={distance:0},i.forEach((function(t){e!==t&&(r[e][t]={distance:Number.POSITIVE_INFINITY})})),n(e).forEach((function(n){var i=n.v===e?n.w:n.v,o=t(n);r[e][i]={distance:o,predecessor:e}}))})),i.forEach((function(e){var t=r[e];i.forEach((function(n){var o=r[n];i.forEach((function(n){var r=o[e],i=t[n],a=o[n],s=r.distance+i.distance;s<a.distance&&(a.distance=s,a.predecessor=i.predecessor)}))}))})),r}(e,t||Ee,n||function(t){return e.outEdges(t)})},isAcyclic:function(e){try{Me(e)}catch(e){if(e instanceof Se)return!1;throw e}return!0},postorder:ze,preorder:Te,prim:function(e,t){var n,r=new M({}),i={},o=new be;function a(e){var r=e.v===n?e.w:e.v,a=o.priority(r);if(void 0!==a){var s=t(e);s<a&&(i[r]=n,o.decrease(r,s))}}if(0===e.nodeCount())return r;for(n of e.nodes())o.add(n,Number.POSITIVE_INFINITY),r.setNode(n);o.decrease(e.nodes()[0],0);for(var s=!1;o.size()>0;){if((n=o.removeMin())in i)r.setEdge(n,i[n]);else{if(s)throw new Error("Input graph is not connected: "+e);s=!0}e.nodeEdges(n).forEach(a)}return r},tarjan:_e,topsort:Me});function Ie(e){me(e=I(e));var t,n=we(e);for(Pe(n),Oe(n,e);t=De(n);)Be(n,e,t,Fe(n,e,t))}function Oe(e,t){var n=ze(e,e.nodes());for(var r of n=n.slice(0,n.length-1))Ae(e,t,r)}function Ae(e,t,n){var r=e.node(n).parent;e.edge(n,r).cutvalue=je(e,t,n)}function je(e,t,n){var r,i,o=e.node(n).parent,a=!0,s=t.edge(n,o),l=0;for(var c of(s||(a=!1,s=t.edge(o,n)),l=s.weight,t.nodeEdges(n))){var u=c.v===n,h=u?c.w:c.v;if(h!==o){var d=u===a,f=t.edge(c).weight;if(l+=d?f:-f,r=n,i=h,e.hasEdge(r,i)){var p=e.edge(n,h).cutvalue;l+=d?-p:p}}}return l}function Pe(e,t){arguments.length<2&&(t=e.nodes()[0]),Re(e,{},1,t)}function Re(e,t,n,r,i){var o=n,a=e.node(r);for(var l of(t[r]=!0,e.neighbors(r)))s(t,l)||(n=Re(e,t,n,l,r));return a.low=o,a.lim=n++,i?a.parent=i:delete a.parent,n}function De(e){for(var t of e.edges())if(e.edge(t).cutvalue<0)return t}function Fe(e,t,n){var r=n.v,i=n.w;t.hasEdge(r,i)||(r=n.w,i=n.v);var o=e.node(r),a=e.node(i),s=o,l=!1;return o.lim>a.lim&&(s=a,l=!0),u(t.edges().filter((function(t){return l===qe(e,e.node(t.v),s)&&l!==qe(e,e.node(t.w),s)})),(e=>ye(t,e)))}function Be(e,t,n,r){var i=n.v,o=n.w;e.removeEdge(i,o),e.setEdge(r.v,r.w,{}),Pe(e),Oe(e,t),function(e,t){var n=function(e,t){for(var n of e.nodes())if(!t.node(n).parent)return n}(e,t),r=Te(e,n);for(var i of r=r.slice(1)){var o=e.node(i).parent,a=t.edge(i,o),s=!1;a||(a=t.edge(o,i),s=!0),t.node(i).rank=t.node(o).rank+(s?a.minlen:-a.minlen)}}(e,t)}function qe(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}function Ve(e){switch(e.graph().ranker){case"network-simplex":We(e);break;case"tight-tree":He(e);break;case"longest-path":Ge(e);break;default:We(e)}}Ie.initLowLimValues=Pe,Ie.initCutValues=Oe,Ie.calcCutValue=je,Ie.leaveEdge=De,Ie.enterEdge=Fe,Ie.exchangeEdges=Be;var Ge=me;function He(e){me(e),we(e)}function We(e){Ie(e)}var $e=Object.freeze({__proto__:null,rank:Ve,tightTreeRanker:He,networkSimplexRanker:We,networkSimplex:Ie,feasibleTree:we,longestPath:me}),Ue=e=>1;function Ye(e,n){if(e.nodeCount()<=1)return[];var r=function(e,n){var r=new S,i=0,o=0;for(var a of e.nodes())r.setNode(a,{v:a,in:0,out:0});for(var s of e.edges()){var l=r.edge(s.v,s.w)||0,c=n(s),u=l+c;r.setEdge(s.v,s.w,u),o=Math.max(o,r.node(s.v).out+=c),i=Math.max(i,r.node(s.w).in+=c)}var h=v(o+i+3,(()=>new t)),d=i+1;for(var a of r.nodes())Qe(h,d,r.node(a));return{graph:r,buckets:h,zeroIdx:d}}(e,n||Ue);return a(function(e,t,n){for(var r,i=[],o=t[t.length-1],a=t[0];e.nodeCount();){for(;r=a.dequeue();)Je(e,t,n,r);for(;r=o.dequeue();)Je(e,t,n,r);if(e.nodeCount())for(var s=t.length-2;s>0;--s)if(r=t[s].dequeue()){i=i.concat(Je(e,t,n,r,!0));break}}return i}(r.graph,r.buckets,r.zeroIdx).map((t=>e.outEdges(t.v,t.w))))}function Je(e,t,n,r,i){var o=i?[]:void 0;for(var a of e.inEdges(r.v)){var s=e.edge(a),l=e.node(a.v);i&&o.push({v:a.v,w:a.w}),l.out-=s,Qe(t,n,l)}for(var a of e.outEdges(r.v)){s=e.edge(a);var c=a.w,u=e.node(c);u.in-=s,Qe(t,n,u)}return e.removeNode(r.v),o}function Qe(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}var Xe={run:function(e){var t="greedy"===e.graph().acyclicer?Ye(e,function(e){return function(t){return e.edge(t).weight}}(e)):function(e){var t=[],n={},r={};function i(o){if(!s(r,o)){for(var a of(r[o]=!0,n[o]=!0,e.outEdges(o)))s(n,a.w)?t.push(a):i(a.w);delete n[o]}}return e.nodes().forEach(i),t}(e);for(var n of t){var r=e.edge(n);e.removeEdge(n),r.forwardName=n.name,r.reversed=!0,e.setEdge(n.w,n.v,r,f("rev"))}},undo:function(e){for(var t of e.edges()){var n=e.edge(t);if(n.reversed){e.removeEdge(t);var r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}}}};function Ze(e){e.children().forEach((function t(n){var r=e.children(n),i=e.node(n);if(r.length&&r.forEach(t),s(i,"minRank")){i.borderLeft=[],i.borderRight=[];for(var o=i.minRank,a=i.maxRank+1;o<a;++o)Ke(e,"borderLeft","_bl",n,i,o),Ke(e,"borderRight","_br",n,i,o)}}))}function Ke(e,t,n,r,i,o){var a={width:0,height:0,rank:o,borderType:t},s=i[t][o-1],l=C(e,"border",a,n);i[t][o]=l,e.setParent(l,r),s&&e.setEdge(s,l,{weight:1})}var et={adjust:function(e){var t=e.graph().rankdir.toLowerCase();"lr"!==t&&"rl"!==t||tt(e)},undo:function(e){var t=e.graph().rankdir.toLowerCase();"bt"!==t&&"rl"!==t||function(e){for(var t of e.nodes())rt(e.node(t));for(var n of e.edges()){var r=e.edge(n);r.points.forEach(rt),s(r,"y")&&rt(r)}}(e),"lr"!==t&&"rl"!==t||(function(e){for(var t of e.nodes())it(e.node(t));for(var n of e.edges()){var r=e.edge(n);r.points.forEach(it),s(r,"x")&&it(r)}}(e),tt(e))}};function tt(e){for(var t of e.nodes())nt(e.node(t));for(var n of e.edges())nt(e.edge(n))}function nt(e){var t=e.width;e.width=e.height,e.height=t}function rt(e){e.y=-e.y}function it(e){var t=e.x;e.x=e.y,e.y=t}var ot=Object.freeze({__proto__:null,debugOrdering:function(e){var t=j(e),n=new S({compound:!0,multigraph:!0}).setGraph({});for(var r of e.nodes())n.setNode(r,{label:r}),n.setParent(r,"layer"+e.node(r).rank);for(var i of e.edges())n.setEdge(i.v,i.w,{},i.name);var o=0;for(var a of t){var s="layer"+o;o++,n.setNode(s,{rank:"same"}),a.reduce((function(e,t){return n.setEdge(e.toString(),t,{style:"invis"}),t}))}return n}}),at={run:function(e){for(var t of(e.graph().dummyChains=[],e.edges()))st(e,t)},undo:function(e){for(var t of e.graph().dummyChains){var n,r=e.node(t),i=r.edgeLabel;for(e.setEdge(r.edgeObj,i);r.dummy;)n=e.successors(t)[0],e.removeNode(t),i.points.push({x:r.x,y:r.y}),"edge-label"===r.dummy&&(i.x=r.x,i.y=r.y,i.width=r.width,i.height=r.height),t=n,r=e.node(t)}}};function st(e,t){var n=t.v,r=e.node(n).rank,i=t.w,o=e.node(i).rank,a=t.name,s=e.edge(t),l=s.labelRank;if(o!==r+1){var c,u,h;for(e.removeEdge(t),h=0,++r;r<o;++h,++r)s.points=[],c=C(e,"edge",u={width:0,height:0,edgeLabel:s,edgeObj:t,rank:r},"_d"),r===l&&(u.width=s.width,u.height=s.height,u.dummy="edge-label",u.labelpos=s.labelpos),e.setEdge(n,c,{weight:s.weight},a),0===h&&e.graph().dummyChains.push(c),n=c;e.setEdge(n,i,{weight:s.weight},a)}}function lt(e){var t=function(e){var t={},n=0;function r(i){var o=n;e.children(i).forEach(r),t[i]={low:o,lim:n++}}return e.children().forEach(r),t}(e);for(var n of e.graph().dummyChains)for(var r=e.node(n),i=r.edgeObj,o=ct(e,t,i.v,i.w),a=o.path,s=o.lca,l=0,c=a[l],u=!0;n!==i.w;){if(r=e.node(n),u){for(;(c=a[l])!==s&&e.node(c).maxRank<r.rank;)l++;c===s&&(u=!1)}if(!u){for(;l<a.length-1&&e.node(c=a[l+1]).minRank<=r.rank;)l++;c=a[l]}e.setParent(n,c),n=e.successors(n)[0]}}function ct(e,t,n,r){var i,o,a=[],s=[],l=Math.min(t[n].low,t[r].low),c=Math.max(t[n].lim,t[r].lim);i=n;do{i=e.parent(i),a.push(i)}while(i&&(t[i].low>l||c>t[i].lim));for(o=i,i=r;(i=e.parent(i))!==o;)s.push(i);return{path:a.concat(s.reverse()),lca:o}}var ut={run:function(e){var t=C(e,"root",{},"_root"),n=function(e){var t={};function n(r,i){var o=e.children(r);if(o&&o.length)for(var a of o)n(a,i+1);t[r]=i}for(var r of e.children())n(r,1);return t}(e),r=Math.max(...p(n))-1,i=2*r+1;for(var o of(e.graph().nestingRoot=t,e.edges()))e.edge(o).minlen*=i;var a=function(e){return e.edges().reduce(((t,n)=>t+e.edge(n).weight),0)}(e)+1;for(var s of e.children())ht(e,t,i,a,r,n,s);e.graph().nodeRankFactor=i},cleanup:function(e){var t=e.graph();for(var n of(e.removeNode(t.nestingRoot),delete t.nestingRoot,e.edges()))e.edge(n).nestingEdge&&e.removeEdge(n)}};function ht(e,t,n,r,i,o,a){var s=e.children(a);if(s.length){var l=D(e,"_bt"),c=D(e,"_bb"),u=e.node(a);for(var h of(e.setParent(l,a),u.borderTop=l,e.setParent(c,a),u.borderBottom=c,s)){ht(e,t,n,r,i,o,h);var d=e.node(h),f=d.borderTop?d.borderTop:h,p=d.borderBottom?d.borderBottom:h,v=d.borderTop?r:2*r,g=f!==p?1:i-o[a]+1;e.setEdge(l,f,{weight:v,minlen:g,nestingEdge:!0}),e.setEdge(p,c,{weight:v,minlen:g,nestingEdge:!0})}e.parent(a)||e.setEdge(t,l,{weight:0,minlen:i+o[a]})}else a!==t&&e.setEdge(t,a,{weight:0,minlen:n})}function dt(e){return"edge-proxy"==e.dummy}function ft(e){return"selfedge"==e.dummy}var pt=50,vt=20,gt=50,mt="tb",yt=1,wt=1,bt=0,xt=0,kt=10,_t="r";function Et(e={}){var t={};for(var n of Object.keys(e))t[n.toLowerCase()]=e[n];return t}function St(e){return e.nodes().map((function(t){var n=e.node(t),r=e.parent(t),i={v:t};return void 0!==n&&(i.value=n),void 0!==r&&(i.parent=r),i}))}function Mt(e){return e.edges().map((function(t){var n=e.edge(t),r={v:t.v,w:t.w};return void 0!==t.name&&(r.name=t.name),void 0!==n&&(r.value=n),r}))}var Nt=Object.freeze({__proto__:null,write:function(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:St(e),edges:Mt(e)};return void 0!==e.graph()&&(t.value=JSON.parse(JSON.stringify(e.graph()))),t},read:function(e){var t=new S(e.options).setGraph(e.value);for(var n of e.nodes)t.setNode(n.v,n.value),n.parent&&t.setParent(n.v,n.parent);for(var n of e.edges)t.setEdge({v:n.v,w:n.w,name:n.name},n.value);return t}}),Lt={Graph:S,GraphLike:M,alg:Ce,json:Nt,PriorityQueue:be};e.Graph=S,e.GraphLike=M,e.PriorityQueue=be,e.acyclic=Xe,e.addBorderSegments=Ze,e.alg=Ce,e.coordinateSystem=et,e.data=i,e.debug=ot,e.graphlib=Lt,e.greedyFAS=Ye,e.json=Nt,e.layout=function(e,t){var n=t&&t.debugTiming?q:V;n("layout",(function(){var t=n("  buildLayoutGraph",(function(){return function(e){var t,n,r,i,o,a,s,l,c,u,h,d,f,p,v,g=new S({multigraph:!0,compound:!0}),m=Et(e.graph()),y={nodesep:null!==(t=m.nodesep)&&void 0!==t?t:gt,edgesep:null!==(n=m.edgesep)&&void 0!==n?n:vt,ranksep:null!==(r=m.ranksep)&&void 0!==r?r:pt,marginx:+(null!==(i=m.marginx)&&void 0!==i?i:0),marginy:+(null!==(o=m.marginy)&&void 0!==o?o:0),acyclicer:m.acyclicer,ranker:null!==(a=m.ranker)&&void 0!==a?a:"network-simplex",rankdir:null!==(s=m.rankdir)&&void 0!==s?s:mt,align:m.align};for(var w of(g.setGraph(y),e.nodes())){var b=Et(e.node(w)),x={width:+(null!==(l=b&&b.width)&&void 0!==l?l:0),height:+(null!==(c=b&&b.height)&&void 0!==c?c:0)};g.setNode(w,x),g.setParent(w,e.parent(w))}for(var k of e.edges()){var _=Et(e.edge(k)),E={minlen:null!==(u=_.minlen)&&void 0!==u?u:yt,weight:null!==(h=_.weight)&&void 0!==h?h:wt,width:null!==(d=_.width)&&void 0!==d?d:bt,height:null!==(f=_.height)&&void 0!==f?f:xt,labeloffset:null!==(p=_.labeloffset)&&void 0!==p?p:kt,labelpos:null!==(v=_.labelpos)&&void 0!==v?v:_t};g.setEdge(k,E)}return g}(e)}));n("  runLayout",(function(){!function(e,t){t("    makeSpaceForEdgeLabels",(function(){!function(e){var t=e.graph();for(var n of(t.ranksep/=2,e.edges())){var r=e.edge(n);r.minlen*=2,"c"!==r.labelpos.toLowerCase()&&("TB"===t.rankdir||"BT"===t.rankdir?r.width+=r.labeloffset:r.height+=r.labeloffset)}}(e)})),t("    removeSelfEdges",(function(){!function(e){for(var t of e.edges())if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}}(e)})),t("    acyclic",(function(){Xe.run(e)})),t("    nestingGraph.run",(function(){ut.run(e)})),t("    rank",(function(){Ve(O(e))})),t("    injectEdgeLabelProxies",(function(){!function(e){for(var t of e.edges()){var n=e.edge(t);if(n.width&&n.height){var r=e.node(t.v),i=e.node(t.w);C(e,"edge-proxy",{rank:(i.rank-r.rank)/2+r.rank,e:t},"_ep")}}}(e)})),t("    removeEmptyRanks",(function(){R(e)})),t("    nestingGraph.cleanup",(function(){ut.cleanup(e)})),t("    normalizeRanks",(function(){P(e)})),t("    assignRankMinMax",(function(){!function(e){var t=0;for(var n of e.nodes()){var r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=Math.max(t,r.maxRank))}e.graph().maxRank=t}(e)})),t("    removeEdgeLabelProxies",(function(){!function(e){for(var t of e.nodes()){var n=e.node(t);dt(n)&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))}}(e)})),t("    normalize.run",(function(){at.run(e)})),t("    parentDummyChains",(function(){lt(e)})),t("    addBorderSegments",(function(){Ze(e)})),t("    order",(function(){Q(e)})),t("    insertSelfEdges",(function(){!function(e){var t,n=j(e);for(var r of n)for(var i=0,o=0;o<r.length;o++){var a=r[o],s=e.node(a);for(var l of(s.order=o+i,null!==(t=s.selfEdges)&&void 0!==t?t:[]))C(e,"selfedge",{width:l.label.width,height:l.label.height,rank:s.rank,order:o+ ++i,e:l.e,label:l.label},"_se");delete s.selfEdges}}(e)})),t("    adjustCoordinateSystem",(function(){et.adjust(e)})),t("    position",(function(){ve(e)})),t("    positionSelfEdges",(function(){!function(e){for(var t of e.nodes()){var n=e.node(t);if(ft(n)){var r=e.node(n.e.v),i=r.x+r.width/2,o=r.y,a=n.x-i,s=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:i+2*a/3,y:o-s},{x:i+5*a/6,y:o-s},{x:i+a,y:o},{x:i+5*a/6,y:o+s},{x:i+2*a/3,y:o+s}],n.label.x=n.x,n.label.y=n.y}}}(e)})),t("    removeBorderNodes",(function(){!function(e){for(var t of e.nodes())if(e.children(t).length){var n=e.node(t),r=e.node(n.borderTop),i=e.node(n.borderBottom),o=e.node(l(n.borderLeft)),a=e.node(l(n.borderRight));n.width=Math.abs(a.x-o.x),n.height=Math.abs(i.y-r.y),n.x=o.x+n.width/2,n.y=r.y+n.height/2}for(var t of e.nodes())"border"===e.node(t).dummy&&e.removeNode(t)}(e)})),t("    normalize.undo",(function(){at.undo(e)})),t("    fixupEdgeLabelCoords",(function(){!function(e){for(var t of e.edges()){var n=e.edge(t);if(s(n,"x"))switch("l"!==n.labelpos&&"r"!==n.labelpos||(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset}}}(e)})),t("    undoCoordinateSystem",(function(){et.undo(e)})),t("    translateGraph",(function(){!function(e){var t,n,r,i=Number.POSITIVE_INFINITY,o=0,a=Number.POSITIVE_INFINITY,l=0,c=e.graph(),u=null!==(t=c.marginx)&&void 0!==t?t:0,h=null!==(n=c.marginy)&&void 0!==n?n:0;function d(e){var t=e.x,n=e.y,r=e.width,s=e.height;i=Math.min(i,t-r/2),o=Math.max(o,t+r/2),a=Math.min(a,n-s/2),l=Math.max(l,n+s/2)}for(var f of e.nodes())d(e.node(f));for(var p of e.edges())s(g=e.edge(p),"x")&&d(g);for(var f of(i-=u,a-=h,e.nodes())){var v=e.node(f);v.x-=i,v.y-=a}for(var p of e.edges()){var g=e.edge(p);for(var m of null!==(r=g.points)&&void 0!==r?r:[])m.x-=i,m.y-=a;g.hasOwnProperty("x")&&(g.x-=i),g.hasOwnProperty("y")&&(g.y-=a)}c.width=o-i+u,c.height=l-a+h}(e)})),t("    assignNodeIntersects",(function(){!function(e){for(var t of e.edges()){var n,r,i=e.edge(t),o=e.node(t.v),a=e.node(t.w);i.points?(n=i.points[0],r=i.points[i.points.length-1]):(i.points=[],n=a,r=o),i.points.unshift(A(o,n)),i.points.push(A(a,r))}}(e)})),t("    reversePoints",(function(){!function(e){for(var t of e.edges()){var n=e.edge(t);n.reversed&&n.points.reverse()}}(e)})),t("    acyclic.undo",(function(){Xe.undo(e)}))}(t,n)})),n("  updateInputGraph",(function(){!function(e,t){for(var n of e.nodes()){var r=e.node(n),i=t.node(n);r&&(r.x=i.x,r.y=i.y,t.children(n).length&&(r.width=i.width,r.height=i.height))}for(var o of e.edges()){var a=e.edge(o),l=t.edge(o);a.points=l.points,s(l,"x")&&(a.x=l.x,a.y=l.y)}e.graph().width=t.graph().width,e.graph().height=t.graph().height}(e,t)}))}))},e.nestingGraph=ut,e.normalize=at,e.order=ee,e.parentDummyChains=lt,e.position=ge,e.rank=$e,e.util=G,e.version="0.1.3",Object.defineProperty(e,"__esModule",{value:!0})}(t)})),p=h(Object.freeze({__proto__:null,default:{}})),v=u((function(e){var t;t=function(e){!function(e){e.buildStyle=function(e,t,n){return void 0===n&&(n={}),{title:{bold:t.bold||!1,underline:t.underline||!1,italic:t.italic||!1,center:t.center||!1},body:{bold:n.bold||!1,underline:n.underline||!1,italic:n.italic||!1,center:n.center||!1},dashed:e.dashed||!1,empty:e.empty||!1,fill:e.fill||void 0,stroke:e.stroke||void 0,visual:e.visual||"class",direction:e.direction||void 0}};var t=function(e,t,n){this.lines=e,this.nodes=t,this.relations=n};e.Compartment=t;var n=function(){};e.Relation=n;var r=function(e,t,n){this.type=e,this.name=t,this.compartments=n,this.dividers=[]};e.Classifier=r}(n||(n={}));var t=this&&this.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r};!function(n){n.layout=function(r,i,o){function a(o,a,d){var f,p,v,g=(p=o.lines,v=a?"normal":"bold",p.length?(r.setFont(i,v,"normal"),{width:Math.round(Math.max.apply(Math,p.map(r.textWidth))+2*i.padding),height:Math.round(r.textHeight()*p.length+2*i.padding)}):{width:0,height:i.padding});if(!o.nodes.length&&!o.relations.length)return o.width=g.width,o.height=g.height,void(o.offset={x:i.padding,y:i.padding});o.nodes.forEach(h);var m=new e.graphlib.Graph;m.setGraph({rankdir:d.direction||i.direction,nodesep:i.spacing,edgesep:i.spacing,ranksep:i.spacing,acyclicer:i.acyclicer,ranker:i.ranker});for(var y=0,w=o.nodes;y<w.length;y++){var b=w[y];m.setNode(b.name,{width:b.layoutWidth,height:b.layoutHeight})}for(var x=0,k=o.relations;x<k.length;x++){var _=k[x];_.assoc.indexOf("_")>-1?m.setEdge(_.start,_.end,{id:_.id,minlen:0}):1!=(null!==(f=i.gravity)&&void 0!==f?f:1)?m.setEdge(_.start,_.end,{id:_.id,minlen:i.gravity}):m.setEdge(_.start,_.end,{id:_.id})}e.layout(m);var E=n.skanaar.indexBy(o.relations,"id"),S=n.skanaar.indexBy(o.nodes,"name");m.nodes().forEach((function(e){var t=m.node(e);S[e].x=t.x,S[e].y=t.y}));var M=0,N=0,L=0,z=0;m.edges().forEach((function(e){var n=m.edge(e),r=S[e.v],i=S[e.w],o=E[n.id];o.path=t([r],n.points,[i]).map(s);var a=o.path[1],h=o.path[o.path.length-2];l(o.startLabel,a,u(c(a,r,4),r,i)),l(o.endLabel,h,u(c(h,i,2),i,r)),M=Math.min.apply(Math,t([M,o.startLabel.x,o.endLabel.x],n.points.map((function(e){return e.x})),n.points.map((function(e){return e.x})))),N=Math.max.apply(Math,t([N,o.startLabel.x+o.startLabel.width,o.endLabel.x+o.endLabel.width],n.points.map((function(e){return e.x})))),L=Math.min.apply(Math,t([L,o.startLabel.y,o.endLabel.y],n.points.map((function(e){return e.y})))),z=Math.max.apply(Math,t([z,o.startLabel.y+o.startLabel.height,o.endLabel.y+o.endLabel.height],n.points.map((function(e){return e.y}))))}));var T=m.graph(),C=Math.max(T.width,N-M),I=Math.max(T.height,z-L),O=I?I+2*i.gutter:0,A=C?C+2*i.gutter:0;o.width=Math.max(g.width,A)+2*i.padding,o.height=g.height+O+i.padding,o.offset={x:i.padding-M,y:i.padding-L}}function s(e){return{x:e.x,y:e.y}}function l(e,t,n){if(e.text){var o=i.fontSize,a=e.text.split("`");e.width=Math.max.apply(Math,a.map((function(e){return r.textWidth(e)}))),e.height=o*a.length,e.x=t.x+(1==n||4==n?i.padding:-e.width-i.padding),e.y=t.y+(3==n||4==n?i.padding:-e.height-i.padding)}else e.width=0,e.height=0,e.x=t.x,e.y=t.y}function c(e,t,n){return e.x<t.x&&e.y<t.y?1:e.x>t.x&&e.y<t.y?2:e.x>t.x&&e.y>t.y?3:e.x<t.x&&e.y>t.y?4:n}function u(e,t,n){if(n.x==t.x||n.y==t.y)return e;if((n.y<t.y?n.x<t.x?2:1:n.x<t.x?3:4)===e){if("LR"===i.direction)return[4,3,2,1][e-1];if("TB"===i.direction)return[2,1,4,3][e-1]}return e}function h(e){var t=i.styles[e.type]||n.styles.CLASS;e.compartments.forEach((function(e,n){a(e,n,t)})),n.layouters[t.visual](i,e),e.layoutWidth=e.width+2*i.edgeMargin,e.layoutHeight=e.height+2*i.edgeMargin}return a(o,0,n.styles.CLASS),o}}(n||(n={}));var n,r=this&&this.__extends||function(){var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(t,n)};return function(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}();!function(e){var t=function(e){function t(){return e.call(this,"max_import_depth exceeded")||this}return r(t,e),t}(Error);e.ImportDepthError=t,e.compileFile=function(t,n){var r=p,i=p,o=i.dirname(t),a=t.substr(o.length);function s(e){return r.readFileSync(i.join(o,e),{encoding:"utf8"})}return e.processImports(s(a),s,n)}}(n||(n={})),function(e){function t(t,n,r,i){var o=e.parse(t),a=o.config,s=function(e,t){return{setFont:function(n,r,i){t.setFont(n.font,r,i,e.fontSize)},textWidth:function(e){return t.measureText(e).width},textHeight:function(){return e.leading*e.fontSize}}}(a,n),l=e.layout(s,a,o.root);return r&&function(e,t,n){e.width=t.width*n,e.height=t.height*n}(r,l,a.zoom*i),a.zoom*=i,e.render(n,a,l,s.setFont),{config:a,layout:l}}e.version="1.3.1",e.draw=function(n,r,i){return t(r,e.skanaar.Canvas(n),n,i||1)},e.renderSvg=function(n,r){var i=e.skanaar.Svg("",r),o=t(n,i,null,1),a=o.config,s=o.layout;return i.serialize({width:s.width,height:s.height},n,a.title)},e.processImports=function t(n,r,i){if(void 0===i&&(i=10),-1==i)throw new e.ImportDepthError;return n.replace(/#import: *(.*)/g,(function(e,n){return t(function(e){try{return r(e)||""}catch(e){return""}}(n),r,i-1)}))}}(n||(n={})),function(e){e.parse=function(t){var n=t.split("\n").map((function(e,t){return{text:e,index:t}})),r=n.filter((function(e){return"#"===e.text[0]})),i={};r.forEach((function(e){try{var t=e.text.substring(1).split(":");i[t[0].trim()]=t[1].trim()}catch(t){throw new Error("line "+(e.index+1)+": Malformed directive")}}));var o=n.map((function(e){return"#"!==(t=e.text)[0]&&"//"!==t.trim().substring(0,2)?t.trim():"";var t})).join("\n");if(""==o)return{root:new e.Compartment([],[],[]),config:c(i)};var a=e.intermediateParse(o);return{root:e.transformParseIntoSyntaxTree(a),config:c(i)};function s(e){return"down"==e?"TB":"right"==e?"LR":"TB"}function l(t){var n=e.skanaar.hasSubstring,r=t.replace(/[a-z]*=[^ ]+/g,""),i=e.skanaar.last(t.match("title=([^ ]*)")||[""]),o=e.skanaar.last(t.match("body=([^ ]*)")||[""]);return{title:{bold:n(i,"bold")||n(r,"bold"),underline:n(i,"underline")||n(r,"underline"),italic:n(i,"italic")||n(r,"italic"),center:!(n(i,"left")||n(t,"align=left"))},body:{bold:n(o,"bold"),underline:n(o,"underline"),italic:n(o,"italic"),center:n(o,"center")},dashed:n(t,"dashed"),empty:n(t,"empty"),fill:e.skanaar.last(t.match("fill=([^ ]*)")||[]),stroke:e.skanaar.last(t.match("stroke=([^ ]*)")||[]),visual:e.skanaar.last(t.match("visual=([^ ]*)")||[])||"class",direction:s(e.skanaar.last(t.match("direction=([^ ]*)")||[]))}}function c(t){var n,r,i={};for(var o in t)if("."==o[0]){var a=t[o];i[o.substring(1).toUpperCase()]=l(a)}return{arrowSize:+t.arrowSize||1,bendSize:+t.bendSize||.3,direction:s(t.direction),gutter:+t.gutter||5,edgeMargin:+t.edgeMargin||0,gravity:+(null!==(n=t.gravity)&&void 0!==n?n:1),edges:"hard"==t.edges?"hard":"rounded",fill:(t.fill||"#eee8d5;#fdf6e3;#eee8d5;#fdf6e3").split(";"),background:t.background||"transparent",fillArrows:"true"===t.fillArrows,font:t.font||"Helvetica",fontSize:+t.fontSize||12,leading:+t.leading||1.25,lineWidth:+t.lineWidth||3,padding:+t.padding||8,spacing:+t.spacing||40,stroke:t.stroke||"#33322E",title:t.title||"",zoom:+t.zoom||1,acyclicer:"greedy"===t.acyclicer?"greedy":void 0,ranker:(r=t.ranker,"network-simplex"==r||"tight-tree"==r||"longest-path"==r?r:"network-simplex"),styles:e.skanaar.merged(e.styles,i)}}},e.intermediateParse=function(e){return i.parse(e)},e.transformParseIntoSyntaxTree=function(t){var n=0;function r(t){var r=[],o=[],a=[];t.forEach((function(e){"string"==typeof e&&r.push(e),void 0!==e.assoc&&(o.push(e.start),o.push(e.end),a.push({id:n++,assoc:e.assoc,start:e.start.parts[0][0],end:e.end.parts[0][0],startLabel:{text:e.startLabel},endLabel:{text:e.endLabel}})),function(e){return void 0!==e.parts}(e)&&o.push(e)}));var s=o.map(i).sort((function(e,t){return t.compartments.length-e.compartments.length})),l=e.skanaar.uniqueBy(s,"name"),c=a.filter((function(e){for(var t=0,n=a;t<n.length;t++){var r=n[t];if(e===r)return!0;if(r.start==e.start&&r.end==e.end)return!1}return!0}));return new e.Compartment(r,l,c)}function i(t){var n=t.parts.map(r);return new e.Classifier(t.type,t.id,n)}return r(t)}}(n||(n={})),function(e){e.render=function(t,n,r,i){var o=t,a=e.skanaar.vector;function s(t,r,a,p){o.save(),o.translate(t.offset.x,t.offset.y),o.fillStyle(r||n.stroke),t.lines.forEach((function(e,r){o.textAlign(a.center?"center":"left");var i=a.center?t.width/2-n.padding:0,s=(.5+(r+.5)*n.leading)*n.fontSize;if(e&&o.fillText(e,i,s),a.underline){var l=o.measureText(e).width;s+=Math.round(.2*n.fontSize)+.5,a.center?o.path([{x:i-l/2,y:s},{x:i+l/2,y:s}]).stroke():o.path([{x:i,y:s},{x:i+l,y:s}]).stroke(),o.lineWidth(n.lineWidth)}})),o.translate(n.gutter,n.gutter),t.relations.forEach((function(t){!function(t){var r=t.path[1],a=t.path[t.path.length-2],s=t.path.slice(1,-1);if(o.fillStyle(n.stroke),i(n,"normal"),d(t.startLabel),d(t.endLabel),"-/-"!==t.assoc&&"_/_"!==t.assoc)if(e.skanaar.hasSubstring(t.assoc,"--")||e.skanaar.hasSubstring(t.assoc,"__")){var p=Math.max(4,2*n.lineWidth);o.setLineDash([p,p]),l(s),o.setLineDash([])}else l(s);function v(e,t,n){">"===e||"<"===e?f(t,u,n,!1):":>"===e||"<:"===e?f(t,c,n,!1):"+"===e?f(t,u,n,h):"o"===e&&f(t,c,n,h)}var g=t.assoc.split(/[-_]/);v(e.skanaar.last(g),s,a),v(g[0],s.reverse(),r)}(t)})),t.nodes.forEach((function(t){!function(t,r){var a=Math.round(t.x-t.width/2),l=Math.round(t.y-t.height/2),c=n.styles[t.type]||e.styles.CLASS;if(o.fillStyle(c.fill||n.fill[r]||e.skanaar.last(n.fill)),o.strokeStyle(c.stroke||n.stroke),c.dashed){var u=Math.max(4,2*n.lineWidth);o.setLineDash([u,u])}var h=e.visualizers[c.visual]||e.visualizers.class;o.setData("name",t.name),h(t,a,l,n,o),o.setLineDash([]),o.save(),o.translate(a,l),t.compartments.forEach((function(e,t){var a=0==t?c.title:c.body;c.empty||(o.save(),o.translate(e.x,e.y),i(n,a.bold?"bold":"normal",a.italic?"italic":void 0),s(e,c.stroke,a,r+1),o.restore())}));for(var d=0,f=t.dividers;d<f.length;d++){var p=f[d];o.path(p).stroke()}o.restore()}(t,p)})),o.restore()}function l(t){if("rounded"===n.edges){var r=n.spacing*n.bendSize;o.beginPath(),o.moveTo(t[0].x,t[0].y);for(var i=1;i<t.length-1;i++)o.arcTo(t[i].x,t[i].y,t[i+1].x,t[i+1].y,r);o.lineTo(e.skanaar.last(t).x,e.skanaar.last(t).y),o.stroke()}else o.path(t).stroke()}var c=!1,u=!0,h=!0;function d(e){if(e&&e.text){var t=n.fontSize;e.text.split("`").forEach((function(n,r){return o.fillText(n,e.x,e.y+t*(r+1))}))}}function f(t,r,i,s){var l=n.spacing*n.arrowSize/30,c=a.diff(t[t.length-2],e.skanaar.last(t)),u=a.normalize(c);function h(e){return a.add(i,a.mult(u,e*l))}var d=h(s?7:10),f=a.rot(u),p=s?h(14):r&&!n.fillArrows?h(5):d,v=[a.add(d,a.mult(f,4*l)),p,a.add(d,a.mult(f,-4*l)),i];o.fillStyle(r?n.stroke:n.fill[0]),o.circuit(v).fillAndStroke()}o.save(),o.scale(n.zoom,n.zoom),o.clear(),o.save(),o.strokeStyle("transparent"),o.fillStyle(n.background),o.rect(0,0,r.width,r.height).fill(),o.restore(),i(n,"bold"),o.lineWidth(n.lineWidth),o.lineJoin("round"),o.lineCap("round"),o.strokeStyle(n.stroke),n.lineWidth%2==1&&o.translate(.5,.5),s(r,void 0,e.buildStyle({},{}).title,0),o.restore()}}(n||(n={})),function(e){!function(e){e.Canvas=function(e,t){var n=e.getContext("2d"),r={x:0,y:0},i=6.2832;function o(t){var n=e;return{x:t.clientX-n.getBoundingClientRect().left-n.clientLeft+n.scrollLeft,y:t.clientY-n.getBoundingClientRect().top-n.clientTop+n.scrollTop}}t&&(e.addEventListener("mousedown",(function(e){t.mousedown&&t.mousedown(o(e))})),e.addEventListener("mouseup",(function(e){t.mouseup&&t.mouseup(o(e))})),e.addEventListener("mousemove",(function(e){r=o(e),t.mousemove&&t.mousemove(o(e))})));var a={stroke:function(){return n.stroke(),a},fill:function(){return n.fill(),a},fillAndStroke:function(){return n.fill(),n.stroke(),a}};function s(e,t,r){r=void 0===r?1:r,t=t||{x:0,y:0},n.beginPath(),n.moveTo(t.x+r*e[0].x,t.y+r*e[0].y);for(var i=1,o=e.length;i<o;i++)n.lineTo(t.x+r*e[i].x,t.y+r*e[i].y);return a}return{mousePos:function(){return r},width:function(){return e.width},height:function(){return e.height},clear:function(){n.clearRect(0,0,e.width,e.height)},circle:function(e,t){return n.beginPath(),n.arc(e.x,e.y,t,0,i),a},ellipse:function(e,t,r,o,s){return void 0===o&&(o=0),void 0===s&&(s=i),n.beginPath(),n.save(),n.translate(e.x,e.y),n.scale(1,r/t),n.arc(0,0,t/2,o,s),n.restore(),a},arc:function(e,t,r,i,o){return n.beginPath(),n.moveTo(e,t),n.arc(e,t,r,i,o),a},roundRect:function(e,t,r,i,o){return n.beginPath(),n.moveTo(e+o,t),n.arcTo(e+r,t,e+r,t+o,o),n.lineTo(e+r,t+i-o),n.arcTo(e+r,t+i,e+r-o,t+i,o),n.lineTo(e+o,t+i),n.arcTo(e,t+i,e,t+i-o,o),n.lineTo(e,t+o),n.arcTo(e,t,e+o,t,o),n.closePath(),a},rect:function(e,t,r,i){return n.beginPath(),n.moveTo(e,t),n.lineTo(e+r,t),n.lineTo(e+r,t+i),n.lineTo(e,t+i),n.closePath(),a},path:s,circuit:function(e,t,r){return s(e,t,r),n.closePath(),a},setFont:function(e,t,r,i){n.font=t+" "+(r||"")+" "+i+"pt "+e+", Helvetica, sans-serif"},fillStyle:function(e){n.fillStyle=e},strokeStyle:function(e){n.strokeStyle=e},textAlign:function(e){n.textAlign=e},lineCap:function(e){n.lineCap=e},lineJoin:function(e){n.lineJoin=e},lineWidth:function(e){n.lineWidth=e},arcTo:function(){return n.arcTo.apply(n,arguments)},beginPath:function(){return n.beginPath.apply(n,arguments)},fillText:function(){return n.fillText.apply(n,arguments)},lineTo:function(){return n.lineTo.apply(n,arguments)},measureText:function(){return n.measureText.apply(n,arguments)},moveTo:function(){return n.moveTo.apply(n,arguments)},restore:function(){return n.restore.apply(n,arguments)},setData:function(e,t){},save:function(){return n.save.apply(n,arguments)},scale:function(){return n.scale.apply(n,arguments)},setLineDash:function(){return n.setLineDash.apply(n,arguments)},stroke:function(){return n.stroke.apply(n,arguments)},translate:function(){return n.translate.apply(n,arguments)}}}}(e.skanaar||(e.skanaar={}))}(n||(n={})),function(e){!function(e){function t(e){return(null!=e?e:"").toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")}e.charWidths={0:10,1:10,2:10,3:10,4:10,5:10,6:10,7:10,8:10,9:10," ":5,"!":5,'"':6,"#":10,$:10,"%":15,"&":11,"'":4,"(":6,")":6,"*":7,"+":10,",":5,"-":6,".":5,"/":5,":":5,";":5,"<":10,"=":10,">":10,"?":10,"@":17,A:11,B:11,C:12,D:12,E:11,F:10,G:13,H:12,I:5,J:9,K:11,L:10,M:14,N:12,O:13,P:11,Q:13,R:12,S:11,T:10,U:12,V:11,W:16,X:11,Y:11,Z:10,"[":5,"\\":5,"]":5,"^":8,_:10,"`":6,a:10,b:10,c:9,d:10,e:10,f:5,g:10,h:10,i:4,j:4,k:9,l:4,m:14,n:10,o:10,p:10,q:10,r:6,s:9,t:5,u:10,v:9,w:12,x:9,y:9,z:9,"{":6,"|":5,"}":6,"~":10},e.Svg=function(n,r){var i=[{x:0,y:0,stroke:"none",strokeWidth:1,dashArray:"none",fill:"none",textAlign:"left",font:"Helvetica, Arial, sans-serif",fontSize:12,attributes:{}}],o=[],a=r?r.createElement("canvas"):null,s=a?a.getContext("2d"):null,l=function(){function e(e,t,n){this.name=e,this.attr=t,this.content=n||void 0}return e.prototype.stroke=function(){var e=this.attr.style||"";return this.attr.style=e+"stroke:"+d("stroke")+";fill:none;stroke-dasharray:"+d("dashArray")+";stroke-width:"+d("strokeWidth")+";",this},e.prototype.fill=function(){var e=this.attr.style||"";return this.attr.style=e+"stroke:none; fill:"+d("fill")+";",this},e.prototype.fillAndStroke=function(){var e=this.attr.style||"";return this.attr.style=e+"stroke:"+d("stroke")+";fill:"+d("fill")+";stroke-dasharray:"+d("dashArray")+";stroke-width:"+d("strokeWidth")+";",this},e}();function c(e,t){return i.forEach((function(n){e+=n[t]})),e}function u(e){return Math.round(10*c(e,"x"))/10}function h(e){return Math.round(10*c(e,"y"))/10}function d(e){for(var t=i.length-1;t>=0;t--)if(i[t][e])return i[t][e]}function f(e){return e[e.length-1]}function p(e,t,n){return n=void 0===n?1:n,t=t||{x:0,y:0},v("path",{d:e.map((function(e,r){return(r?"L":"M")+u(t.x+n*e.x)+" "+h(t.y+n*e.y)})).join(" ")})}function v(e,t,n){var r=new l(e,t,n),i=d("attributes");for(var a in i)r.attr["data-"+a]=i[a];return o.push(r),r}return{width:function(){return 0},height:function(){return 0},clear:function(){},circle:function(e,t){return v("circle",{r:t,cx:u(e.x),cy:h(e.y)})},ellipse:function(e,t,n,r,i){if(i){var o=h(e.y);return v("path",{d:"M"+u(e.x-t/2)+" "+o+"A"+t/2+" "+n/2+" 0 1 0 "+u(e.x+t/2)+" "+o})}return v("ellipse",{cx:u(e.x),cy:h(e.y),rx:t/2,ry:n/2})},arc:function(e,t,n){return v("ellipse",{cx:u(e),cy:h(t),rx:n,ry:n})},roundRect:function(e,t,n,r,i){return v("rect",{x:u(e),y:h(t),rx:i,ry:i,height:r,width:n})},rect:function(e,t,n,r){return v("rect",{x:u(e),y:h(t),height:r,width:n})},path:p,circuit:function(e,t,n){var r=p(e,t,n);return r.attr.d+=" Z",r},setFont:function(e,t,n,r){e=t+" "+(n||"")+" "+r+"pt "+e+", Helvetica, sans-serif",f(i).font=e,f(i).fontSize=r},strokeStyle:function(e){f(i).stroke=e},fillStyle:function(e){f(i).fill=e},arcTo:function(e,t,n,r){f(o).attr.d+="L"+u(e)+" "+h(t)+" L"+u(n)+" "+h(r)+" "},beginPath:function(){return v("path",{d:""})},fillText:function(e,t,n){var r={x:u(t),y:h(n),style:"fill: "+f(i).fill+";"},o=d("font");return o&&(r.style+="font:"+o+";"),"center"===d("textAlign")&&(r.style+="text-anchor: middle;"),v("text",r,e)},lineCap:function(e){n+=";stroke-linecap:"+e},lineJoin:function(e){n+=";stroke-linejoin:"+e},lineTo:function(e,t){return f(o).attr.d+="L"+u(e)+" "+h(t)+" ",f(o)},lineWidth:function(e){f(i).strokeWidth=e},measureText:function(t){return s?(s.font=d("font")||"normal 12pt Helvetica",s.measureText(t)):{width:e.sum(t,(function(t){var n=d("fontSize")/12;return e.charWidths[t]?e.charWidths[t]*n:16*n}))}},moveTo:function(e,t){f(o).attr.d+="M"+u(e)+" "+h(t)+" "},restore:function(){i.pop()},save:function(){i.push({x:0,y:0,stroke:null,strokeWidth:null,fill:null,textAlign:null,dashArray:"none",font:null,fontSize:null,attributes:null})},setData:function(e,t){d("attributes")[e]=t},scale:function(){},setLineDash:function(e){f(i).dashArray=0===e.length?"none":e[0]+" "+e[1]},stroke:function(){f(o).stroke()},textAlign:function(e){f(i).textAlign=e},translate:function(e,t){f(i).x+=e,f(i).y+=t},serialize:function(e,r,i){function a(e){return Object.keys(e).map((function(n){return n+'="'+t(e[n])+'"'})).join(" ")}var s=o;r&&s.unshift(new l("desc",{},r)),i&&s.unshift(new l("title",{},i));var c=s.map((function(e){return"<"+e.name+" "+a(e.attr)+">"+t(e.content)+"</"+e.name+">"})).join("\n  ");return"<svg "+a({version:"1.1",baseProfile:"full",width:e.width,height:e.height,viewbox:"0 0 "+e.width+" "+e.height,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:ev":"http://www.w3.org/2001/xml-events",style:"font:"+d("font")+";"+n})+">\n  "+c+"\n</svg>"}}}}(e.skanaar||(e.skanaar={}))}(n||(n={})),function(e){!function(e){e.range=function(e,t){for(var n=e[0],r=e[1],i=[],o=0;o<t;o++)i.push(n+(r-n)*o/(t-1));return i},e.sum=function(e,t){for(var n=0,r=0,i=e.length;n<i;n++)r+=t(e[n]);return r},e.find=function(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return e[n]},e.last=function(e){return e[e.length-1]},e.hasSubstring=function(e,t){return""===t||!!e&&-1!==e.indexOf(t)},e.merged=function(e,t){function n(e,t){for(var n in t)e[n]=t[n]}var r={};return n(r,e),n(r,t),r},e.indexBy=function(e,t){for(var n={},r=0;r<e.length;r++)n[e[r][t]]=e[r];return n},e.uniqueBy=function(e,t){for(var n={},r=[],i=0;i<e.length;i++){var o=e[i][t];n[o]||(n[o]=!0,r.push(e[i]))}return r}}(e.skanaar||(e.skanaar={}))}(n||(n={})),function(e){!function(e){e.vector={dist:function(t,n){return e.vector.mag(e.vector.diff(t,n))},add:function(e,t){return{x:e.x+t.x,y:e.y+t.y}},diff:function(e,t){return{x:e.x-t.x,y:e.y-t.y}},mult:function(e,t){return{x:t*e.x,y:t*e.y}},mag:function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},normalize:function(t){return e.vector.mult(t,1/e.vector.mag(t))},rot:function(e){return{x:e.y,y:-e.x}}}}(e.skanaar||(e.skanaar={}))}(n||(n={})),function(e){function n(t,n){n.width=Math.max.apply(Math,n.compartments.map((function(e){return e.width}))),n.height=e.skanaar.sum(n.compartments,(function(e){return e.height})),n.dividers=[];for(var r=0,i=0,o=n.compartments;i<o.length;i++){var a=o[i];a.x=0,a.y=r,a.width=n.width,r+=a.height,a!=e.skanaar.last(n.compartments)&&n.dividers.push([{x:0,y:r},{x:n.width,y:r}])}}function r(e,t){t.dividers=[],t.compartments=[],t.width=2.5*e.fontSize,t.height=2.5*e.fontSize}e.styles={ABSTRACT:e.buildStyle({visual:"class"},{center:!0,italic:!0}),ACTOR:e.buildStyle({visual:"actor"},{center:!0},{center:!0}),CHOICE:e.buildStyle({visual:"rhomb"},{center:!0},{center:!0}),CLASS:e.buildStyle({visual:"class"},{center:!0,bold:!0}),DATABASE:e.buildStyle({visual:"database"},{center:!0,bold:!0},{center:!0}),END:e.buildStyle({visual:"end",empty:!0},{}),FRAME:e.buildStyle({visual:"frame"},{}),HIDDEN:e.buildStyle({visual:"hidden",empty:!0},{}),INPUT:e.buildStyle({visual:"input"},{center:!0}),INSTANCE:e.buildStyle({visual:"class"},{center:!0,underline:!0}),LABEL:e.buildStyle({visual:"none"},{}),NOTE:e.buildStyle({visual:"note"},{}),PACKAGE:e.buildStyle({visual:"package"},{}),RECEIVER:e.buildStyle({visual:"receiver"},{}),REFERENCE:e.buildStyle({visual:"class",dashed:!0},{center:!0}),SENDER:e.buildStyle({visual:"sender"},{}),START:e.buildStyle({visual:"start",empty:!0},{}),STATE:e.buildStyle({visual:"roundrect"},{center:!0}),TABLE:e.buildStyle({visual:"table"},{center:!0,bold:!0}),TRANSCEIVER:e.buildStyle({visual:"transceiver"},{}),USECASE:e.buildStyle({visual:"ellipse"},{center:!0},{center:!0})},e.layouters={actor:function(n,r){r.width=Math.max.apply(Math,t([2*n.padding],r.compartments.map((function(e){return e.width})))),r.height=3*n.padding+e.skanaar.sum(r.compartments,(function(e){return e.height})),r.dividers=[];for(var i=3*n.padding,o=0,a=r.compartments;o<a.length;o++){var s=a[o];s.x=0,s.y=i,s.width=r.width,i+=s.height,s!=e.skanaar.last(r.compartments)&&r.dividers.push([{x:n.padding,y:i},{x:r.width-n.padding,y:i}])}},class:n,database:function(t,n){n.width=Math.max.apply(Math,n.compartments.map((function(e){return e.width}))),n.height=e.skanaar.sum(n.compartments,(function(e){return e.height}))+2*t.padding,n.dividers=[];for(var r=1.5*t.padding,i=0,o=n.compartments;i<o.length;i++){var a=o[i];if(a.x=0,a.y=r,a.width=n.width,r+=a.height,a!=e.skanaar.last(n.compartments)){var s=e.skanaar.range([0,Math.PI],16).map((function(e){return{x:.5*n.width*(1-Math.cos(e)),y:r+t.padding*(.75*Math.sin(e)-.5)}}));n.dividers.push(s)}}},ellipse:function(t,n){var r=Math.max.apply(Math,n.compartments.map((function(e){return e.width}))),i=e.skanaar.sum(n.compartments,(function(e){return e.height}));n.width=1.25*r,n.height=1.25*i,n.dividers=[];for(var o=.125*i,a=function(e){return e*e},s=function(e){return Math.sqrt(a(.5)-a(e/n.height-.5))*n.width},l=0,c=n.compartments;l<c.length;l++){var u=c[l];u.x=.125*r,u.y=o,u.width=r,o+=u.height,u!=e.skanaar.last(n.compartments)&&n.dividers.push([{x:n.width/2+s(o)-1,y:o},{x:n.width/2-s(o)+1,y:o}])}},end:r,frame:function(e,t){var r=t.compartments[0].width,i=t.compartments[0].height;n(0,t),t.dividers.length&&t.dividers.shift(),t.dividers.unshift([{x:0,y:i},{x:r-i/4,y:i},{x:r+i/4,y:i/2},{x:r+i/4,y:0}])},hidden:function(e,t){t.dividers=[],t.compartments=[],t.width=1,t.height=1},input:n,none:n,note:n,package:n,receiver:n,rhomb:function(t,n){var r=Math.max.apply(Math,n.compartments.map((function(e){return e.width}))),i=e.skanaar.sum(n.compartments,(function(e){return e.height}));n.width=1.5*r,n.height=1.5*i,n.dividers=[];for(var o=.25*i,a=0,s=n.compartments;a<s.length;a++){var l=s[a];l.x=.25*r,l.y=o,l.width=r,o+=l.height;var c=n.width/n.height;l!=e.skanaar.last(n.compartments)&&n.dividers.push([{x:n.width/2+(o<n.height/2?o*c:(n.height-o)*c),y:o},{x:n.width/2-(o<n.height/2?o*c:(n.height-o)*c),y:o}])}},roundrect:n,sender:n,start:r,table:function(r,i){if(1!=i.compartments.length){for(var o,a,s=i.compartments.slice(1),l=[[]],c=0,u=s;c<u.length;c++){var h=u[c];h==e.skanaar.last(s)||(a=h).lines.length||a.nodes.length||a.relations.length||!e.skanaar.last(l).length?(o=void 0,o=e.skanaar.last(l),l[0]!=o&&l[0].length==o.length?l.push([h]):e.skanaar.last(l).push(h)):l.push([])}var d=i.compartments[0],f=Math.max.apply(Math,t([d.width/l[0].length],s.map((function(e){return e.width})))),p=Math.max.apply(Math,s.map((function(e){return e.height})));i.width=f*l[0].length,i.height=d.height+p*l.length;var v=d.height;i.dividers=t([[{x:0,y:d.height},{x:0,y:d.height}]],l.map((function(e,t){return[{x:0,y:v+t*p},{x:i.width,y:v+t*p}]})),l[0].map((function(e,t){return[{x:(t+1)*f,y:v},{x:(t+1)*f,y:i.height}]}))),d.x=0,d.y=0,d.width=i.width;for(var g=0;g<l.length;g++)for(var m=0;m<l[g].length;m++){var y=l[g][m];y.x=m*f,y.y=v+g*p,y.width=f}}else n(0,i)},transceiver:n},e.visualizers={actor:function(e,t,n,r,i){var o=r.padding/2,a=n+4*o,s={x:e.x,y:a-o};i.circle(s,o).fillAndStroke(),i.path([{x:e.x,y:a},{x:e.x,y:a+2*o}]).stroke(),i.path([{x:e.x-o,y:a+o},{x:e.x+o,y:a+o}]).stroke(),i.path([{x:e.x-o,y:a+o+r.padding},{x:e.x,y:a+r.padding},{x:e.x+o,y:a+o+r.padding}]).stroke()},class:function(e,t,n,r,i){i.rect(t,n,e.width,e.height).fillAndStroke()},database:function(e,t,n,r,i){var o=r.padding,a=n-o/2;i.rect(t,n+o,e.width,e.height-1.5*o).fill(),i.path([{x:t,y:a+1.5*o},{x:t,y:a-.5*o+e.height}]).stroke(),i.path([{x:t+e.width,y:a+1.5*o},{x:t+e.width,y:a-.5*o+e.height}]).stroke(),i.ellipse({x:e.x,y:a+1.5*o},e.width,1.5*o).fillAndStroke(),i.ellipse({x:e.x,y:a-.5*o+e.height},e.width,1.5*o,0,3.1416).fillAndStroke()},ellipse:function(e,t,n,r,i){i.ellipse({x:e.x,y:e.y},e.width,e.height).fillAndStroke()},end:function(e,t,n,r,i){i.circle({x:e.x,y:n+e.height/2},e.height/3).fillAndStroke(),i.fillStyle(r.stroke),i.circle({x:e.x,y:n+e.height/2},e.height/3-r.padding/2).fill()},frame:function(e,t,n,r,i){i.rect(t,n,e.width,e.height).fillAndStroke()},hidden:function(e,t,n,r,i){},input:function(e,t,n,r,i){i.circuit([{x:t+r.padding,y:n},{x:t+e.width,y:n},{x:t+e.width-r.padding,y:n+e.height},{x:t,y:n+e.height}]).fillAndStroke()},none:function(e,t,n,r,i){},note:function(e,t,n,r,i){i.circuit([{x:t,y:n},{x:t+e.width-r.padding,y:n},{x:t+e.width,y:n+r.padding},{x:t+e.width,y:n+e.height},{x:t,y:n+e.height},{x:t,y:n}]).fillAndStroke(),i.path([{x:t+e.width-r.padding,y:n},{x:t+e.width-r.padding,y:n+r.padding},{x:t+e.width,y:n+r.padding}]).stroke()},package:function(e,t,n,r,i){var o=e.compartments[0].height;i.rect(t,n+o,e.width,e.height-o).fillAndStroke();var a=i.measureText(e.name).width+2*r.padding;i.circuit([{x:t,y:n+o},{x:t,y:n},{x:t+a,y:n},{x:t+a,y:n+o}]).fillAndStroke()},receiver:function(e,t,n,r,i){i.circuit([{x:t-r.padding,y:n},{x:t+e.width,y:n},{x:t+e.width,y:n+e.height},{x:t-r.padding,y:n+e.height},{x:t,y:n+e.height/2}]).fillAndStroke()},rhomb:function(e,t,n,r,i){i.circuit([{x:e.x,y:n},{x:t+e.width,y:e.y},{x:e.x,y:n+e.height},{x:t,y:e.y}]).fillAndStroke()},roundrect:function(e,t,n,r,i){var o=Math.min(2*r.padding*r.leading,e.height/2);i.roundRect(t,n,e.width,e.height,o).fillAndStroke()},sender:function(e,t,n,r,i){i.circuit([{x:t,y:n},{x:t+e.width-r.padding,y:n},{x:t+e.width,y:n+e.height/2},{x:t+e.width-r.padding,y:n+e.height},{x:t,y:n+e.height}]).fillAndStroke()},start:function(e,t,n,r,i){i.fillStyle(r.stroke),i.circle({x:e.x,y:n+e.height/2},e.height/2.5).fill()},table:function(e,t,n,r,i){i.rect(t,n,e.width,e.height).fillAndStroke()},transceiver:function(e,t,n,r,i){i.circuit([{x:t-r.padding,y:n},{x:t+e.width,y:n},{x:t+e.width+r.padding,y:n+e.height/2},{x:t+e.width,y:n+e.height},{x:t-r.padding,y:n+e.height},{x:t,y:n+e.height/2}]).fillAndStroke()}}}(n||(n={}));var i=function(){var e=function(e,t,n,r){for(n=n||{},r=e.length;r--;n[e[r]]=t);return n},t=[1,5],n=[1,8],r=[5,6,12,14],i=[12,14],o=[1,22],a={trace:function(){},yy:{},symbols_:{error:2,root:3,compartment:4,EOF:5,SEP:6,slot:7,IDENT:8,class:9,association:10,parts:11,"|":12,"[":13,"]":14,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",6:"SEP",8:"IDENT",12:"|",13:"[",14:"]"},productions_:[0,[3,2],[3,3],[3,4],[3,3],[7,1],[7,1],[7,1],[4,1],[4,3],[11,1],[11,3],[11,2],[10,3],[9,3]],performAction:function(e,t,n,r,i,o,a){var s=o.length-1;switch(i){case 1:case 2:return o[s-1];case 3:case 4:return o[s-2];case 5:this.$=o[s].trim().replace(/\\(\[|\]|\|)/g,"$1");break;case 6:case 7:this.$=o[s];break;case 8:case 10:this.$=[o[s]];break;case 9:this.$=o[s-2].concat(o[s]);break;case 11:this.$=o[s-2].concat([o[s]]);break;case 12:this.$=o[s-1].concat([[]]);break;case 13:var l=o[s-1].trim().replace(/\\(\[|\]|\|)/g,"$1").match("^(.*?)([<:o+]*[-_]/?[-_]*[:o+>]*)(.*)$");if(!l)throw new Error("line "+a[s].first_line+": Classifiers must be separated by a relation or a line break");this.$={assoc:l[2],start:o[s-2],end:o[s],startLabel:l[1].trim(),endLabel:l[3].trim()};break;case 14:var c="CLASS",u=o[s-1][0][0],h=o[s-1][0][0].match("<([a-z]*)>(.*)");h&&(c=h[1].toUpperCase(),u=h[2].trim()),o[s-1][0][0]=u,this.$={type:c,id:u,parts:o[s-1]}}},table:[{3:1,4:2,6:[1,3],7:4,8:t,9:6,10:7,13:n},{1:[3]},{5:[1,9],6:[1,10]},{4:11,7:4,8:t,9:6,10:7,13:n},e(r,[2,8]),e(r,[2,5]),e(r,[2,6],{8:[1,12]}),e(r,[2,7]),{4:14,7:4,8:t,9:6,10:7,11:13,13:n},{1:[2,1]},{5:[1,15],7:16,8:t,9:6,10:7,13:n},{5:[1,17],6:[1,18]},{9:19,13:n},{12:[1,21],14:[1,20]},e(i,[2,10],{6:o}),{1:[2,4]},e(r,[2,9]),{1:[2,2]},{5:[1,23],7:16,8:t,9:6,10:7,13:n},e(r,[2,13]),e([5,6,8,12,14],[2,14]),e(i,[2,12],{7:4,9:6,10:7,4:24,8:t,13:n}),{7:16,8:t,9:6,10:7,13:n},{1:[2,3]},e(i,[2,11],{6:o})],defaultActions:{9:[2,1],15:[2,4],17:[2,2],23:[2,3]},parseError:function(e,t){if(!t.recoverable){var n=new Error(e);throw n.hash=t,n}this.trace(e)},parse:function(e){var t=this,n=[0],r=[null],i=[],o=this.table,a="",s=0,l=0,c=2,u=1,h=i.slice.call(arguments,1),d=Object.create(this.lexer),f={yy:{}};for(var p in this.yy)Object.prototype.hasOwnProperty.call(this.yy,p)&&(f.yy[p]=this.yy[p]);d.setInput(e,f.yy),f.yy.lexer=d,f.yy.parser=this,void 0===d.yylloc&&(d.yylloc={});var v=d.yylloc;i.push(v);var g=d.options&&d.options.ranges;"function"==typeof f.yy.parseError?this.parseError=f.yy.parseError:this.parseError=Object.getPrototypeOf(this).parseError;for(var m,y,w,b,x,k,_,E,S=function(){var e;return"number"!=typeof(e=d.lex()||u)&&(e=t.symbols_[e]||e),e},M={};;){if(y=n[n.length-1],this.defaultActions[y]?w=this.defaultActions[y]:(null==m&&(m=S()),w=o[y]&&o[y][m]),void 0===w||!w.length||!w[0]){var N="";for(x in E=[],o[y])this.terminals_[x]&&x>c&&E.push("'"+this.terminals_[x]+"'");N=d.showPosition?"Parse error on line "+(s+1)+":\n"+d.showPosition()+"\nExpecting "+E.join(", ")+", got '"+(this.terminals_[m]||m)+"'":"Parse error on line "+(s+1)+": Unexpected "+(m==u?"end of input":"'"+(this.terminals_[m]||m)+"'"),this.parseError(N,{text:d.match,token:this.terminals_[m]||m,line:d.yylineno,loc:v,expected:E})}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+y+", token: "+m);switch(w[0]){case 1:n.push(m),r.push(d.yytext),i.push(d.yylloc),n.push(w[1]),m=null,l=d.yyleng,a=d.yytext,s=d.yylineno,v=d.yylloc;break;case 2:if(k=this.productions_[w[1]][1],M.$=r[r.length-k],M._$={first_line:i[i.length-(k||1)].first_line,last_line:i[i.length-1].last_line,first_column:i[i.length-(k||1)].first_column,last_column:i[i.length-1].last_column},g&&(M._$.range=[i[i.length-(k||1)].range[0],i[i.length-1].range[1]]),void 0!==(b=this.performAction.apply(M,[a,l,s,f.yy,w[1],r,i].concat(h))))return b;k&&(n=n.slice(0,-1*k*2),r=r.slice(0,-1*k),i=i.slice(0,-1*k)),n.push(this.productions_[w[1]][0]),r.push(M.$),i.push(M._$),_=o[n[n.length-2]][n[n.length-1]],n.push(_);break;case 3:return!0}}return!0}},s={EOF:1,parseError:function(e,t){if(!this.yy.parser)throw new Error(e);this.yy.parser.parseError(e,t)},setInput:function(e,t){return this.yy=t||this.yy||{},this._input=e,this._more=this._backtrack=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];return this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e,e.match(/(?:\r\n?|\n).*/g)?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this.yyleng=this.yytext.length,this},more:function(){return this._more=!0,this},reject:function(){return this.options.backtrack_lexer?(this._backtrack=!0,this):this.parseError("Lexical error on line "+(this.yylineno+1)+". You can only invoke reject() in the lexer when the lexer is of the backtracking persuasion (options.backtrack_lexer = true).\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=new Array(e.length+1).join("-");return e+this.upcomingInput()+"\n"+t+"^"},test_match:function(e,t){var n,r,i;if(this.options.backtrack_lexer&&(i={yylineno:this.yylineno,yylloc:{first_line:this.yylloc.first_line,last_line:this.last_line,first_column:this.yylloc.first_column,last_column:this.yylloc.last_column},yytext:this.yytext,match:this.match,matches:this.matches,matched:this.matched,yyleng:this.yyleng,offset:this.offset,_more:this._more,_input:this._input,yy:this.yy,conditionStack:this.conditionStack.slice(0),done:this.done},this.options.ranges&&(i.yylloc.range=this.yylloc.range.slice(0))),(r=e[0].match(/(?:\r\n?|\n).*/g))&&(this.yylineno+=r.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:r?r[r.length-1].length-r[r.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+e[0].length},this.yytext+=e[0],this.match+=e[0],this.matches=e,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._backtrack=!1,this._input=this._input.slice(e[0].length),this.matched+=e[0],n=this.performAction.call(this,this.yy,this,t,this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1),n)return n;if(this._backtrack){for(var o in i)this[o]=i[o];return!1}return!1},next:function(){if(this.done)return this.EOF;var e,t,n,r;this._input||(this.done=!0),this._more||(this.yytext="",this.match="");for(var i=this._currentRules(),o=0;o<i.length;o++)if((n=this._input.match(this.rules[i[o]]))&&(!t||n[0].length>t[0].length)){if(t=n,r=o,this.options.backtrack_lexer){if(!1!==(e=this.test_match(n,i[o])))return e;if(this._backtrack){t=!1;continue}return!1}if(!this.options.flex)break}return t?!1!==(e=this.test_match(t,i[r]))&&e:""===this._input?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var e=this.next();return e||this.lex()},begin:function(e){this.conditionStack.push(e)},popState:function(){return this.conditionStack.length-1>0?this.conditionStack.pop():this.conditionStack[0]},_currentRules:function(){return this.conditionStack.length&&this.conditionStack[this.conditionStack.length-1]?this.conditions[this.conditionStack[this.conditionStack.length-1]].rules:this.conditions.INITIAL.rules},topState:function(e){return(e=this.conditionStack.length-1-Math.abs(e||0))>=0?this.conditionStack[e]:"INITIAL"},pushState:function(e){this.begin(e)},stateStackSize:function(){return this.conditionStack.length},options:{},performAction:function(e,t,n,r){switch(n){case 0:return 12;case 1:return 8;case 2:return 13;case 3:return 14;case 4:return 6;case 5:return 5;case 6:return"INVALID"}},rules:[/^(?:\s*\|\s*)/,/^(?:(\\(\[|\]|\|)|[^\]\[|;\n])+)/,/^(?:\[)/,/^(?:\s*\])/,/^(?:[ ]*(;|\n)+[ ]*)/,/^(?:$)/,/^(?:.)/],conditions:{INITIAL:{rules:[0,1,2,3,4,5,6],inclusive:!0}}};function l(){this.yy={}}return a.lexer=s,l.prototype=a,a.Parser=l,new l}();return n},e.exports?e.exports=t(f):window.nomnoml=t(graphre)})),g=Object.freeze(Object.assign(Object.create(null),v,{default:v})),m=function(){function e(e){this.canvasElement=e,this.filename="graph",this.source=""}return e.prototype.pngDownload=function(){var e=this,t=this.canvasElement;t.msToBlob?d(t.msToBlob(),this.filename+".png"):this.canvasElement.toBlob((function(t){return d(t,e.filename+".png")}))},e.prototype.svgDownload=function(){var e=v.renderSvg(this.source,document);d(new Blob([e],{type:"image/svg+xml"}),this.filename+".svg")},e.prototype.srcDownload=function(){var e=this.source;d(new Blob([e],{type:"text/txt"}),this.filename+".nomnoml")},e.prototype.setFilename=function(e){e=e||"nomnoml",this.filename=e.replace(/[^ a-zA-Z0-9_-]/g,"_")},e}(),y=function(e,t){return(y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)};function w(e,t){function n(){this.constructor=e}y(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}function b(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var x=function(){function e(){this.callbacks={}}return e.prototype.on=function(e,t){this.callbacks[e]||(this.callbacks[e]=[]),this.callbacks[e].push(t)},e.prototype.off=function(e,t){var n=this.callbacks[e];if(n){var r=n.indexOf(t);-1!==r&&n.splice(r,1),0===n.length&&delete this.callbacks[e]}},e.prototype.trigger=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=this.callbacks[e];r&&r.forEach((function(e){return e.apply(null,t)}))},e}(),k=function(){function e(e,t){this.context=e,this.path=t}return e.from=function(t){var n=t.indexOf("/");return"#"==t[0]&&n>-1?{context:e.urlDecode(t.substr(1,n-1)),path:e.urlDecode(t.substr(n+1))}:{context:null,path:null}},e.urlEncode=function(e){return encodeURIComponent(e).replace(/'/g,"%27").replace(/"/g,"%22")},e.urlDecode=function(e){return decodeURIComponent(e.replace(/\+/g," "))},e}(),_=function(){function e(){this.signals=new x,this.on=this.signals.on,this.off=this.signals.off,this.storage=new M}return e.prototype.files=function(){return JSON.parse(localStorage["nomnoml.file_index"]||"[]")},e.prototype.setFiles=function(e){localStorage["nomnoml.file_index"]=JSON.stringify(e),this.signals.trigger("updated")},e.prototype.moveToFileStorage=function(e,t){var n={name:e,date:(new Date).toISOString(),backingStore:"local_file"},r=this.files();r.push(n),r.sort((function(e,t){return e.name.localeCompare(t.name)})),localStorage["nomnoml.file_index"]=JSON.stringify(r),new S(n.name).save(t),this.signals.trigger("updated")},e.prototype.moveToLocalStorage=function(e){this.storage=new M,this.storage.save(e)},e.prototype.discard=function(e){new S(e.name).clear(),this.setFiles(this.files().filter((function(t){return t.name!=e.name}))),this.signals.trigger("updated")},e.prototype.configureByRoute=function(e){var t=k.from(e);this.storage=this.routedStorage(t);var n=(new Date).toISOString();"file"==t.context?this.activeFile=this.files().filter((function(e){return e.name===t.path}))[0]||{name:t.path,date:n,backingStore:"local_file"}:"view"==t.context?this.activeFile={name:"",date:n,backingStore:"url"}:this.activeFile={name:"",date:n,backingStore:"local_default"},this.signals.trigger("updated")},e.prototype.routedStorage=function(e){return"view"===e.context?new N(decodeURIComponent(e.path)):"file"===e.context?new S(e.path):new M},e}(),E=function(){function e(e){this.key=e}return e.prototype.read=function(){return localStorage[this.key]},e.prototype.save=function(e){localStorage[this.key]=e},e.prototype.clear=function(){localStorage.removeItem(this.key)},e}(),S=function(e){function t(t){var n=e.call(this,"nomnoml.files/"+t)||this;return n.kind="local_file",n}return w(t,e),t}(E),M=function(e){function t(){var t=e.call(this,"nomnoml.lastSource")||this;return t.kind="local_default",t}return w(t,e),t}(E),N=function(){function e(e){this.source=e,this.kind="url"}return e.prototype.read=function(){return this.source},e.prototype.save=function(e){},e.prototype.clear=function(){},e}(),L=function(e,t,n){function r(n){return function(){n?t.classList.add(e):t.classList.remove(e)}}for(var i=0,o=n;i<o.length;i++){var a=o[i];a.addEventListener("mouseenter",r(!0)),a.addEventListener("mouseleave",r(!1))}},z=function(){function e(e){var t=this;this.dynamicButton=null,this.signals=new x,this.on=this.signals.on,this.off=this.signals.off;var n=document.querySelector("body"),i=document.getElementById("linenumbers"),a=document.getElementById("linemarker"),c=document.getElementById("textarea"),u=document.getElementById("canvas"),h=document.getElementById("canvas-panner");this.editor=e.fromTextArea(c,{lineNumbers:!0,mode:"nomnoml",matchBrackets:!0,theme:"solarized light",keyMap:"sublime"}),this.editor.on("drop",(function(e,n){var r=n.dataTransfer.files;"image/svg+xml"==r[0].type&&(n.preventDefault(),t.handleOpeningFiles(r))}));var d=this.editor.getWrapperElement();this.filesystem=new _;var f=new l(d,a,i);this.panner=new s(h,(function(){return t.sourceChanged()})),this.downloader=new m(u),new L("canvas-mode",n,[h]),this.defaultSource=(document.getElementById("defaultGraph")||{innerHTML:""}).innerHTML;var p=null,g=function(){p=null,t.filesystem.configureByRoute(location.hash);var e=t.filesystem.storage.read()||"";t.editor.setValue(e||t.defaultSource),t.sourceChanged()};function y(e){return new S(e).read()}window.addEventListener("hashchange",(function(){return g()})),window.addEventListener("resize",o((function(){return t.sourceChanged()}),750,{leading:!0})),this.editor.on("changes",function(e,t,n){var i,o;function a(t,n){i=null,n&&(o=e.apply(t,n))}return void 0===n&&(n=!1),function(){for(var s=[],l=0;l<arguments.length;l++)s[l]=arguments[l];if(i&&clearTimeout(i),n){var c=!i;i=setTimeout(a,t),c&&(o=e.apply(this,s))}else i=r(a,t,this,s);return o}}((function(){return t.sourceChanged()}),300)),this.sourceChanged=function(){try{t.signals.trigger("compile-error",null),f.clearState();var e=t.editor.getValue(),n=function(e){try{return v.processImports(e,y)}catch(e){if(e instanceof v.ImportDepthError)return"Error: too many imports";throw e}}(e),r=v.draw(u,n,t.panner.zoom());p=e,t.panner.positionCanvas(u),t.filesystem.storage.save(e),t.downloader.source=e,t.downloader.setFilename(r.config.title||t.filesystem.activeFile.name),t.signals.trigger("source-changed",e)}catch(e){t.signals.trigger("compile-error",e),p&&v.draw(u,p,t.panner.zoom()),t.panner.positionCanvas(u),f.setError(e)}},g()}return e.prototype.loadSvg=function(e){var t=(new DOMParser).parseFromString(e,"text/xml");if(1===t.getElementsByTagName("desc").length){var n=t.getElementsByTagName("desc")[0].childNodes[0].nodeValue;n=i(n),this.editor.setValue(n)}else alert("SVG did not have nomnoml code embedded within it.")},e.prototype.currentSource=function(){return this.editor.getValue()},e.prototype.magnifyViewport=function(e){this.panner.magnify(e)},e.prototype.resetViewport=function(){this.panner.reset()},e.prototype.toggleSidebar=function(e){for(var t=0,n=["about","reference","export","files"];t<n.length;t++){var r=n[t];e!==r&&document.getElementById(r).classList.remove("visible")}document.getElementById(e).classList.toggle("visible")},e.prototype.discardCurrentGraph=function(){confirm("Do you want to discard current diagram and load the default example?")&&(this.editor.setValue(this.defaultSource),this.sourceChanged())},e.prototype.saveAs=function(){var e=prompt("Name your diagram");if(e){if(this.filesystem.files().some((function(t){return t.name===e})))return void alert("A file named "+e+" already exists.");this.filesystem.moveToFileStorage(e,this.currentSource()),location.href="#file/"+encodeURIComponent(e)}},e.prototype.exitViewMode=function(){window.location.href="./"},e.prototype.handleOpeningFiles=function(e){var t=this;if(1===e.length){var n=new FileReader;n.onload=function(){return t.loadSvg(n.result)},n.readAsText(e[0])}else alert("You can only upload one file at a time.")},e}(),T=n.createElement,C=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return T.apply(void 0,b(["div"],e))},I=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return T.apply(void 0,b(["span"],e))},O=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return T.apply(void 0,b(["h2"],e))},A=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return T.apply(void 0,b(["a"],e))};function j(e){return function(t){t.preventDefault(),e(t)}}var P={"link-outline":"M17.5 6c.3 0 .6.1.8.3.4.5.4 1.1 0 1.6l-1.7 1.7.3.3c.5.6.9 1.4.9 2.2s-.4 1.6-1 2.2l-4.1 4.2c-.6.5-1.4.9-2.2.9s-1.6-.4-2.2-1l-.3-.2-1.7 1.7a1 1 0 0 1-1.6 0c-.4-.5-.4-1.1 0-1.6l1.7-1.7-.3-.3c-.5-.6-.9-1.4-.9-2.2s.4-1.6 1-2.2l4.1-4.2c.6-.5 1.4-.8 2.2-.8s1.6.3 2.2.8l.3.3 1.7-1.7c.2-.2.5-.3.8-.3m0-2a3 3 0 0 0-2.2 1l-.5.4a5.2 5.2 0 0 0-5.9 1l-4.2 4a5 5 0 0 0-1 6l-.4.5a3 3 0 0 0 0 4.4 3 3 0 0 0 4.4 0l.5-.5a5 5 0 0 0 5.9-1l4.2-4a5 5 0 0 0 1-6l.4-.5a3 3 0 0 0 0-4.4 3 3 0 0 0-2.2-.9zm-6.1 7.2a2 2 0 0 0 2 2L11.6 15a2 2 0 0 0-2-2l1.8-1.8M12.5 9c-.2 0-.5.1-.6.3l-4.2 4.2c-.2.1-.3.4-.3.6 0 .2.1.5.3.6l.3.3.7-.7a1 1 0 0 1 1.6 0c.4.5.4 1.1 0 1.6l-.7.7.3.3c.1.2.4.3.6.3l.6-.3 4.2-4.2c.2-.1.3-.4.3-.6 0-.2-.1-.5-.3-.6l-.3-.3-.7.7a1 1 0 0 1-1.6 0c-.4-.5-.4-1.1 0-1.6l.7-.7-.3-.3a.9.9 0 0 0-.6-.3z","camera-outline":"M19 20h-14c-1.6 0-3-1.3-3-3v-8c0-1.6 1.3-3 3-3h1.5l1-1c.5-.5 1.5-1 2.4-1h4c.8 0 1.8.4 2.4 1l1 1h1.5c1.6 0 3 1.3 3 3v8c0 1.6-1.3 3-3 3zm-14-12c-.5 0-1 .4-1 1v8c0 .5.4 1 1 1h14c.5 0 1-.4 1-1v-8c0-.5-.4-1-1-1h-2c-.2 0-.52-.1-.7-.2l-1.2-1.2c-.2-.2-.7-.4-1-.4h-4c-.2 0-.7.2-1 .4l-1.2 1.2c-.1.1-.4.2-.7.2h-2zM12 10c1.3 0 2.5 1.1 2.5 2.5s-1.1 2.5-2.5 2.5-2.5-1.1-2.5-2.5 1.1-2.5 2.5-2.5m0-1c-1.9 0-3.5 1.5-3.5 3.5 0 1.9 1.5 3.5 3.5 3.5s3.5-1.5 3.5-3.5c0-1.9-1.5-3.5-3.5-3.5zM18 8.6c-.7 0-1.3.5-1.3 1.3s.5 1.2 1.3 1.2 1.3-.58 1.3-1.2-.5-1.3-1.3-1.3z","image-outline":"M8.5 7.9c.8 0 1.5.6 1.5 1.5s-.6 1.5-1.5 1.5-1.5-.6-1.5-1.5.6-1.5 1.5-1.5m0-1c-1.3 0-2.5 1.1-2.5 2.5s1.1 2.5 2.5 2.5 2.5-1.1 2.5-2.5-1.1-2.5-2.5-2.5zM16 11.9c.45.0 1.27 1.8 1.7 4.0h-11.3c.4-1.0 1.0-2.0 1.6-2.0.8 0 1.1.1 1.53.42.4.2 1.0.58 1.97.58 1.1 0 1.9-.8 2.6-1.6.6-.6 1.2-1.3 1.8-1.3m0-1c-2 0-3 3-4.5 3s-1.4-1-3.5-1c-2 0-3.0 4-3.0 4h14.0s-1-6-3-6zM22 6c0-1.1-.8-2-2-2h-16c-1.1 0-2 .8-2 2v12c0 1.1.8 2 2 2h16c1.1 0 2-.8 2-2v-12zm-2 12h-16v-12h16.0l-.0 12z","download-outline":"M20.9 17c0-.1-.0-.2-.0-.3l-2-6c-.1-.4-.5-.6-.9-.6h-.5l.6-.6c1.17-1.17 1.17-3.0 0-4.2-.81-.8-2.0-1.0-3.1-.7v-1.3c0-1.6-1.3-3-3-3s-3 1.3-3 3v1.3c-1.0-.3-2.3-.1-3.1.7-1.17 1.17-1.17 3.0.0 4.2l.68.6h-.5c-.4 0-.8.2-.9.6l-2 6c-.0.1-.0.2-.0.3-.0 0-.0 5-.0 5 0 .5.4 1 1 1h16c.5 0 1-.4 1-1 0 0 0-5-.0-5zm-13.6-10.5c.1-.1.4-.2.7-.2s.5.1.7.2l2.2 2.2v-5.7c0-.5.4-1 1-1s1 .4 1 1v5.7l2.2-2.2c.3-.3 1.0-.3 1.4 0 .3.39.3 1.0.0 1.4l-4.7 4.6-4.7-4.6c-.3-.3-.3-1.0 0-1.4zm-.5 5.5h1.8l3.4 3.41 3.4-3.41h1.8l1.6 5h-13.8l1.6-5zm12.2 9h-14v-3h14v3z","document-add":"M15 12h-2v-2c0-.5-.4-1-1-1s-1 .4-1 1v2h-2c-.5 0-1 .4-1 1s.4 1 1 1h2v2c0 .5.4 1 1 1s1-.4 1-1v-2h2c.5 0 1-.4 1-1s-.4-1-1-1zM19.7 7.2l-4-4c-.1-.1-.4-.2-.7-.2h-8c-1.6 0-3 1.3-3 3v12c0 1.6 1.3 3 3 3h10c1.6 0 3-1.3 3-3v-10c0-.2-.1-.52-.2-.7zm-2.1.7h-1.0c-.8 0-1.5-.6-1.5-1.5v-1.0l2.5 2.5zm-.5 11h-10c-.5 0-1-.4-1-1v-12c0-.5.4-1 1-1h7v1.5c0 1.3 1.1 2.5 2.5 2.5h1.5v9c0 .5-.4 1-1 1z","home-outline":"M22.2 10.4c-3.39-2.8-9.5-8.1-9.6-8.2l-.6-.5-.6.5c-.0.0-6.2 5.3-9.66 8.2-.4.3-.6.9-.6 1.5 0 1.1.8 2 2 2h1v6c0 1.1.8 2 2 2h12c1.1 0 2-.8 2-2v-6h1c1.1 0 2-.8 2-2 0-.5-.2-1.1-.7-1.5zm-8.2 9.5h-4v-5h4v5zm4-8l.0 8h-3.0v-6h-6v6h-3v-8h-3.0c2.7-2.3 7.3-6.2 9.0-7.68 1.6 1.4 6.2 5.3 9 7.6l-3-.0z",trash:"M18 7h-1v-1c0-1.1-.8-2-2-2h-7c-1.1 0-2 .8-2 2v1h-1c-.5 0-1 .4-1 1s.4 1 1 1v8c0 2.2 1.7 4 4 4h5c2.2 0 4-1.7 4-4v-8c.5 0 1-.4 1-1s-.4-1-1-1zm-10-1h7v1h-7v-1zm8 11c0 1.1-.8 2-2 2h-5c-1.1 0-2-.8-2-2v-8h9v8zM8.5 10.5c-.2 0-.5.2-.5.5v6c0 .2.2.5.5.5s.5-.2.5-.5v-6c0-.2-.2-.5-.5-.5zM10.5 10.5c-.2 0-.5.2-.5.5v6c0 .2.2.5.5.5s.5-.2.5-.5v-6c0-.2-.2-.5-.5-.5zM12.5 10.5c-.2 0-.5.2-.5.5v6c0 .2.2.5.5.5s.5-.2.5-.5v-6c0-.2-.2-.5-.5-.5zM14.5 10.5c-.2 0-.5.2-.5.5v6c0 .2.2.5.5.5s.5-.2.5-.5v-6c0-.2-.2-.5-.5-.5z",plus:"M18 10h-4v-4c0-1.1-.8-2-2-2s-2 .8-2 2l.0 4h-4.0c-1.1 0-2 .8-2 2s.8 2 2 2l4.0-.0-.0 4.0c0 1.1.8 2 2 2s2-.8 2-2v-4.0l4 .0c1.1 0 2-.8 2-2s-.8-2-2-2z",equals:"M18 7h-12c-1.1 0-2 .8-2 2s.8 2 2 2h12c1.1 0 2-.8 2-2s-.8-2-2-2zM18 14h-12c-1.1 0-2 .8-2 2s.8 2 2 2h12c1.1 0 2-.8 2-2s-.8-2-2-2z",minus:"M18 11h-12c-1.1 0-2 .8-2 2s.8 2 2 2h12c1.1 0 2-.8 2-2s-.8-2-2-2z","info-outline":"M14.2 16l.6-1c.8-1.7.9-3.3.2-4.6a4 4 0 0 0-.4-.7 4 4 0 1 0-5-1.6 6.7 6.7 0 0 0-3 1.4A2 2 0 0 0 7.9 13l-.6 1c-.8 1.7-.9 3.3-.2 4.6.5 1.2 1.6 2 3 2.3a6.3 6.3 0 0 0 5.3-1.4 2 2 0 0 0-1-3.5zM13 4a2 2 0 1 1 0 4 2 2 0 0 1 0-4zm-1.8 15h-.9C8.7 18.5 8 17 9 15l1-2c.5-1 .5-1.6-.1-2-.2-.2-.4-.2-.7-.2L8 11s1.1-1 2.8-1h.9c1.6.4 2.3 2 1.3 4l-1 2c-.5 1-.5 1.6.1 2 .2.2.4.2.7.2L14 18s-1.1 1-2.8 1z","document-text":"M17 21H7a3 3 0 0 1-3-3V6a3 3 0 0 1 3-3h10a3 3 0 0 1 3 3v12a3 3 0 0 1-3 3zM7 5a1 1 0 0 0-1 1v12c0 .6.4 1 1 1h10c.6 0 1-.4 1-1V6c0-.6-.4-1-1-1H7zm9 6H8a.5.5 0 0 1 0-1h8a.5.5 0 0 1 0 1zm0-3H8a.5.5 0 0 1 0-1h8a.5.5 0 0 1 0 1zm0 6H8a.5.5 0 0 1 0-1h8a.5.5 0 0 1 0 1zm0 3H8a.5.5 0 0 1 0-1h8a.5.5 0 0 1 0 1z","arrow-down-outline":"M12 21.312l-7.121-7.121c-1.17-1.17-1.17-3.073 0-4.242 1.094-1.094 2.978-1.138 4.121-.115v-4.834c0-1.654 1.346-3 3-3s3 1.346 3 3v4.834c1.143-1.023 3.027-.979 4.121.115 1.17 1.169 1.17 3.072 0 4.242l-7.121 7.121zm-5-10.242c-.268 0-.518.104-.707.293-.391.39-.391 1.023 0 1.414l5.707 5.707 5.707-5.707c.391-.391.391-1.024 0-1.414-.379-.379-1.035-.379-1.414 0l-3.293 3.293v-9.656c0-.551-.448-1-1-1s-1 .449-1 1v9.656l-3.293-3.293c-.189-.189-.439-.293-.707-.293z","folder-open":"M22.3 8h-2.4c-.4-1.2-1.5-2-2.8-2h-6c0-1.1-.9-2-2-2h-4.1c-1.7 0-3 1.3-3 3v10c0 1.7 1.3 3 3 3h12c1.7 0 3.4-1.3 3.8-3l2.2-8c.1-.6-.2-1-.7-1zm-18.3 1v-2c0-.6.4-1 1-1h4c0 1.1.9 2 2 2h6c.6 0 1 .4 1 1h-11.1c-.6 0-1.1.4-1.3 1l-1.6 6.3v-7.3zm14.9 7.5c-.2.8-1.1 1.5-1.9 1.5h-12s-.4-.2-.2-.8l1.9-7c0-.1.2-.2.3-.2h13.7l-1.8 6.5z",folder:"M18 6h-6c0-1.1-.8-2-2-2h-4c-1.6 0-3 1.3-3 3v10c0 1.6 1.3 3 3 3h12c1.6 0 3-1.3 3-3v-8c0-1.6-1.3-3-3-3zm-12 0h4c0 1.1.8 2 2 2h6c.5 0 1 .4 1 1h-14v-2c0-.5.4-1 1-1zm12 12h-12c-.5 0-1-.4-1-1v-7h14v7c0 .5-.4 1-1 1z","weather-cloudy":"M17 19h-11c-2.2 0-4-1.7-4-4 0-1.8 1.2-3.4 3.0-3.8l-.0-.1c0-3.3 2.6-6 6-6 2.5 0 4.8 1.6 5.65 4.0 2.9-.2 5.35 2.1 5.35 4.9 0 2.7-2.2 5-5 5zm-11.0-6.0c-1.0.0-1.9.9-1.9 2.0s.8 2 2 2h11c1.6 0 3-1.3 3-3s-1.3-3-3-3c-.2 0-.5.0-.81.13l-1.0.3-.1-1.1c-.3-1.9-1.9-3.3-3.9-3.3-2.2 0-4 1.7-4 4 0 .2.0.5.0.8l.2 1.1-1.4-.0z",globe:"M12.1 3.3q2.6 0 4.8 1.3Q19 6 20.3 8.1q1.2 2.1 1.2 4.7t-1.3 4.7Q19 19.7 16.8 21q-2.2 1.3-4.7 1.3-2.6 0-4.8-1.3-2.1-1.3-3.4-3.4-1.2-2.2-1.2-4.7Q2.7 10 4 8q1.2-2.2 3.4-3.4 2.2-1.3 4.7-1.3zm-.7 2.2Q10 6 9.2 8.3q1 .3 2.2.4V5.5zm1.4 3.2q1.1 0 2.2-.4-.7-2.3-2.2-2.8v3.2zm2.6-2.6q.6.9.9 1.8l1-.5q-.8-.7-1.9-1.3zM8 8l.9-1.8q-1 .5-1.8 1.3L8 8zm11.5 4.2q0-2-1.3-3.7-.8.6-1.5.8.3 1.4.4 2.9h2.4zm-11.9-3Q6.9 9 6 8.4 5 10 4.7 12.1h2.5q0-1.5.4-2.9zm3.8.9l-2.6-.5q-.2 1.1-.2 2.5h2.8V10zm4.2 2q0-1.4-.2-2.5l-2.6.5v2h2.8zM4.7 13.4q.3 2 1.4 3.7l1.5-.8q-.3-1.4-.4-2.9H4.7zm3.9 0q0 1.4.2 2.5l2.6-.5v-2H8.6zm4.2 2l2.6.5q.2-1.1.2-2.5h-2.8v2zm3.8.9q.7.2 1.5.8 1.1-1.6 1.3-3.7H17q0 1.5-.4 2.9zM12.8 20q1.5-.5 2.2-2.8l-2.2-.4V20zm-1.4-3.2q-1.1 0-2.2.4.7 2.3 2.2 2.8v-3.2zm-3.5.8L7 18l1.8 1.2-.8-1.7zm8.4 0q-.3 1-.9 1.7 1-.4 1.8-1.2l-1-.5z"};function R(e){var t=e.id?P[e.id]:e.shape;return T("i",{className:"icon"},T("svg",{version:"1.2",baseProfile:"tiny",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:"24",height:"24"},T("path",{d:t})))}function D(e){return C({className:"canvas-tools"},C({className:"canvas-button"},A({title:"Zoom in",onClick:j((function(){return e.app.magnifyViewport(2)}))},T(R,{id:"plus"}))),C({className:"canvas-button"},A({title:"Reset zoom and panning",onClick:j((function(){return e.app.resetViewport()}))},T(R,{id:"equals"}))),C({className:"canvas-button"},A({title:"Zoom out",onClick:j((function(){return e.app.magnifyViewport(-2)}))},T(R,{id:"minus"}))))}function F(e){var t=e.app.downloader,n=e.app.downloader.source;return C({className:"file-menu"},O({},"Share diagram"),A({className:"btn",href:"#view/"+k.urlEncode(n),target:"_blank"},T(R,{id:"link-outline"}),"Shareable link"),A({className:"btn",href:"image.svg?source="+k.urlEncode(n),target:"_blank"},T(R,{id:"globe"}),"Server hosted SVG"),O({},"Downloads"),A({className:"btn",href:"/",onClick:j((function(){return t.pngDownload()}))},T(R,{id:"camera-outline"}),"PNG image"),T("p",{},"Downloaded image files will be given the filename in the ",T("tt",{},"#title")," directive"),A({className:"btn",href:"/",onClick:j((function(){return t.svgDownload()}))},T(R,{id:"image-outline"}),"SVG with source"),T("p",{},"Downloaded SVG files will have the source code embedded. Open an exported SVG file to load it's nomnoml source."),A({className:"btn",href:"/",onClick:j((function(){return t.srcDownload()}))},T(R,{id:"download-outline"}),"Source code"))}function B(e){for(var t=e.app.filesystem,n=t.files(),r="local_file"===t.storage.kind,i="local_default"===t.storage.kind,o=[],a=null,s=0,l=n;s<l.length;s++){var c=l[s],u=c.name.split("/"),h=u.pop(),d=u.join("/");a!=d&&""!==d&&(a=d,o.push({isDir:!0,name:d,entry:null})),o.push({isDir:!1,name:h,entry:c})}function f(e){return"#file/"+encodeURIComponent(e.name).replace(/%20/g,"+").replace(/%2F/g,"/")}function p(e,n){var i,o=(i=n,r&&t.activeFile.name===i.name?"active ":""),a=e===n.name?"":"indented";return C({key:n.name,className:"file-entry "+o+a},A({href:f(n)},e),A({onClick:j((function(){return function(e){confirm('Permanently delete "'+e.name+'"')&&t.discard(e)}(n)})),title:"Discard this diagram"},T(R,{id:"trash"})))}return C({className:"file-menu"},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return T.apply(void 0,b(["label"],e))}({className:"btn"},T(R,{id:"image-outline"}),"Open SVG with source...",function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return T.apply(void 0,b(["input"],e))}({type:"file",accept:"image/svg+xml",onChange:j((function(t){var n=t.target.files;e.app.handleOpeningFiles(n)}))})),A({className:"btn",href:"/",onClick:j((function(){return e.app.saveAs()}))},T(R,{id:"document-add"}),"Save to local file..."),T("p",{},"Import files with the #import directive",T("br",{}),T("code",{},"#import: filename")),T("p",{},"Use ",T("code",{},"/")," in your file names to specify folders."),O({},"Local files"),C({className:"file-entry "+(i?"active":"")},A({href:"#"},T(R,{id:"home-outline"}),"Home")),o.map((function(e){return e.isDir?function(e){return C({key:"//dir/"+e,className:"file-entry directory"},A({href:"javascript:void(0)"},T(R,{id:"folder"}),e))}(e.name):p(e.name,e.entry)})))}function q(e){var t="url"==e.app.filesystem.storage.kind,n="local_file"==e.app.filesystem.storage.kind,r=j((function(){return e.app.saveAs()}));return t?C({className:"system-banners"},I({className:"banner card visible"},"View mode, changes are not saved.",A({onClick:r,href:"/",title:"Save this diagram to localStorage"},"save"),A({href:"#",title:"Discard this diagram"},"close"))):n?C({className:"system-banners"},I({className:"banner card visible"},'Editing "'+e.app.filesystem.activeFile.name+'"',A({href:"#",title:"Exit from this file"},"close"))):C({className:"system-banners"})}function V(e){var t=n.useState(null),r=t[0],i=t[1];function o(e){i(e?{title:"Compile error",details:e.message}:null)}return n.useEffect((function(){return e.app.signals.on("compile-error",o),function(){return e.app.signals.off("compile-error",o)}})),C({className:"terminal-banners"},r&&I({className:"banner card card-warning visible"},r.title,T("br"),T("tt",{},r.details)))}function G(e){var t=n.useState(""),r=t[0],i=t[1],o=e.app;return C({className:"tools"},A({className:"logo",onClick:j((function(){return o.toggleSidebar("about")})),onMouseLeave:function(){return i("")},onMouseEnter:function(){return i("About nomnoml")}},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return T.apply(void 0,b(["h1"],e))}({},"nomnoml ")),A({onClick:j((function(){return o.toggleSidebar("about")})),onMouseLeave:function(){return i("")},onMouseEnter:function(){return i("About nomnoml")}},T(R,{id:"info-outline"})),A({onClick:j((function(){return o.toggleSidebar("reference")})),onMouseLeave:function(){return i("")},onMouseEnter:function(){return i("Language reference")}},T(R,{id:"document-text"})),A({onClick:j((function(){return o.toggleSidebar("export")})),onMouseLeave:function(){return i("")},onMouseEnter:function(){return i("Export this diagram")}},T(R,{id:"arrow-down-outline"})),A({onClick:j((function(){return o.toggleSidebar("files")})),onMouseLeave:function(){return i("")},onMouseEnter:function(){return i("Save this or load another diagram")}},T(R,{id:"folder-open"})),o.dynamicButton?o.dynamicButton(o,i):A({onClick:j((function(){return o.discardCurrentGraph()})),onMouseLeave:function(){return i("")},onMouseEnter:function(){return i("Discard current diagram")}},T(R,{id:"trash"})),C({id:"tooltip"},r),T(q,{app:o}),T(V,{app:o}))}e.DailyTip=function(e){var t="hide"!=localStorage[e.id],r=n.useState(!0),i=(r[0],r[1]);return e.source,C({className:"alert card "+(t?"":"alert-hidden")},function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return T.apply(void 0,b(["b"],e))}({},e.message),e.source&&function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return T.apply(void 0,b(["pre"],e))}({},e.source),e.source&&!e.hidePreview&&I({dangerouslySetInnerHTML:{__html:v.renderSvg(e.source)}}),A({className:"alert-close",onClick:j((function(){localStorage[e.id]="hide",i(!1)}))},""))},e.bootstrap=function(e){var n=new z(e),r=function(e){return document.querySelector(e)};function o(){t.render(T(B,{app:n}),r("[file-menu]")),t.render(T(F,{app:n}),r("[export-menu]")),t.render(T(G,{app:n}),r("[menu]")),t.render(T(D,{app:n}),r("[canvas-tools]"))}o(),n.signals.on("source-changed",o),n.signals.on("compile-error",o),n.filesystem.signals.on("updated",o),function(){for(var e={},t=document.querySelectorAll("[publish-as-file]"),n=0;n<t.length;n++){var r=t[n].attributes.getNamedItem("publish-as-file").value;e[r]=i(t[n].innerHTML)}var o=document.querySelectorAll("[append-nomnoml-preview]");for(n=0;n<o.length;n++){var a=o[n],s=v.processImports(i(a.innerHTML),(function(t){return e[t]})),l=v.renderSvg(s,document),c=document.createElement("div");c.innerHTML=l,a.append(c)}}()},e.nomnoml=g,Object.defineProperty(e,"__esModule",{value:!0})}));
