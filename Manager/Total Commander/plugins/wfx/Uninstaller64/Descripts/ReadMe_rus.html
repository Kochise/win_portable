<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="ru" lang="ru" dir="ltr">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Описание плагина Uninstaller64</title>
  
  <style type="text/css">
    body {
      background-color: #eeffff;
      font-family: serif;
      font-size: 12pt;
    }
    h1 {
      font-size: 18pt;
      font-weight: bold;
    }
    h2 {
      font-size: 16pt;
      font-weight: bold;
      text-decoration: underline;
    }
    h3 {
      font-size: 12pt;
      font-weight: bold;
      margin-bottom: 0.5em;
    }
    p {
      text-align: justify;
    }
    td {
      vertical-align: top;
    }
    td.ini-key {
      padding-top: 2pt;
      font-family: monospace;
      font-size: 10pt;
      color: #000080;
    }
    code {
      font-family: monospace;
      font-size: 10pt;
      color: #000080;
    }
    .nobr {
      white-space: nowrap;
    }
  </style>
</head>

<body>

<h1>Uninstaller64</h1>
<p>
<b>Версия 1.0.1</b>
</p>
<p>
Плагин для Total Commander, позволяющий управлять списком установленных в системе приложений.
</p>

<table border="0" cellpadding="0" cellspacing="2">
  <tr><td><b>Автор:</b></td><td style="width: 0.3em;"></td><td>Власов Константин, 2012 г.</td></tr>
  <tr><td><b>Домашняя страница:</b></td><td style="width: 0.3em;"></td><td><a href="http://flint-inc.ru/rus/info/uninstaller64.html" target="_blank">http://flint-inc.ru/</a></td></tr>
  <tr><td><b>E-mail:</b></td><td style="width: 0.3em;"></td><td><a href="mailto:support@flint_inc.ru?Subject=Uninstaller64">support@flint_inc.ru</a></td></tr>
</table>

<p>
Распространяется по лицензии <a href="Artistic%20License%202.0.html">Artistic License 2.0</a>.
</p>

<p>
<b>Системные требования:</b><br />
</p>
<ul>
  <li>
    <b>32-битная версия:</b><br />
    Windows 2000 и выше<br />
    Total Commander 7.50&ndash;8.0<br />
  </li>
  <li>
    <b>64-битная версия:</b><br />
    Процессор с поддержкой 64-битных команд (Intel Pentium 4, AMD Athlon 64 и выше)<br />
    Windows XP x64 и выше<br />
    Total Commander 8.0 x64
  </li>
</ul>


<a name="description"></a><h2>Описание</h2>
<p>
Данный плагин позволяет просматривать список установленных приложений в окне Total Commander, просматривать информацию о соответствующих записях деинсталляции, запускать деинсталляцию и принудительно удалять нерабочие записи. Разработка велась по мотивам плагина <a href="http://wincmd.ru/plugring/uninstaller.html" target="_blank">UnInstaller</a>, который длительное время не развивался и больше не подходит для использования в современных системах, не поддерживая ни Юникода, ни 64-битных систем. Плагин Uninstaller64 создан для предоставления тех же возможностей, но с учётом последних нововведений как в архитектуре Windows, так и в функциональности Total Commander. Стоит заметить, что текущая версия Uninstaller64 не полностью перекрывает функциональность UnInstaller, а именно, не поддерживается отображение расширенной информации об установленных обновлениях Windows. Впрочем, в UnInstaller она работает только в Windows XP и более старых системах, поэтому данный недостаток не критичен. И тем не менее, добавление этой функции запланировано на будущие версии (если получится, то и с поддержкой современных версий Windows). Более подробный список нововведений Uninstaller64 приведён в разделе <a href="#history">История версий</a>.
</p>


<a name="installation"></a><h2>Установка и использование</h2>
<p>
Для установки плагина просто откройте архив с ним в Total Commander и согласитесь на установку. Если автоустановка у вас отключена, то см. инструкции в справке Total Commander. 
</p>
<p>
После установки в панели сетевого окружения TC появляется дополнительная папка с названием <b>Uninstaller64</b>. При заходе в эту папку выводится список установленных приложений. У каждой записи имеется фиктивное расширение вида <code>.L00D7</code>, играющее двойную роль. Во-первых, если бы имя записи состояло только из отображаемого имени приложения, то TC отделял бы часть имени после последней точки и считал бы это расширением, некрасиво разрывая имя на две части. Во-вторых, дописываемый суффикс устроен таким образом, что даже если в системе обнаружатся несколько приложений с одинаковыми именами, в панели TC не будет конфликтов, т.к. у них окажутся разные суффиксы. Кроме того, первая буква суффикса позволяет определить тип установки приложения. Если это <code><b>U</b></code>, то приложение установлено только для текущего пользователя, а если <code><b>L</b></code>, то это общесистемная установка. Кроме того, в 64-битных Windows для общесистемных приложений, установленных как 32-битные, будет использоваться буква <code><b>W</b></code>.
</p>
<p>
При выборе записи и нажатии <code>F3</code> открывается внутренний просмотрщик с информацией о записи деинсталляции. Также запись можно просто скопировать в виде файла, содержащего тот же текст. Содержимое представляет собой HTML-документ, поэтому рекомендуется пользоваться плагином просмотра наподобие <a href="http://wincmd.ru/plugring/htmlview.html" target="_blank">HTMLView</a>. Прочесть информацию можно будет и без него, возможностей встроенного просмотрщика TC по разбору и отображению HTML достаточно для корректного вывода его в виде текста, но плагины позволят улучшить оформление.
</p>
<p>
Нажатие <code>Alt+Enter</code> на записи или выбор команды <b>Свойства</b> в контекстном меню открывает диалог свойств, в котором можно редактировать основные параметры выбранной записи. Если прав пользователя недостаточно для модификации соответствующего ключа реестра, редактирование полей будет недоступно. В этом случае для модификации выбранной записи необходимо перезапустить Total Commander с правами Администратора.
</p>
<p>
Нажатие <code>Enter</code> запускает деинсталлятор для записи под курсором. Если нажать <code>Del</code> или <code>F8</code>, то после подтверждения запись будет удалена из реестра. Пользуйтесь этой функцией с осторожностью! После этого вы не сможете деинсталлировать приложение штатным образом.
</p>


<a name="configuration"></a><h2>Настройка плагина</h2>
<p>
Чтобы вызвать диалог настройки плагина, откройте панель сетевого окружения в TC, выберите плагин и нажмите <code>Alt+Enter</code> (то же самое произойдёт при выборе команды <b>Свойства</b> в контекстном меню). Диалог содержит следующие опции:
</p>
<ul>
  <li><b>Отображать скрытые записи</b><br />
    Если эта опция включена, плагин также отображает записи, отмеченные как скрытые. Скрытыми считаются записи, для которых в реестре не задано читабельное имя или которые по какой-либо причине не содержат информации о команде деинсталляции, а также системные компоненты. Запуск деинсталляции для таких пунктов не рекомендуется.
  </li>
  <li><b>Получать значки для скрытых записей</b><br />
    Если скрытые записи отображаются, то, в зависимости от этой опции, у них может быть либо стандартный значок, использующийся TC для скрытых файлов, либо значок, заданный в реестре. Имейте в виду, что подавляющее большинство скрытых записей не предполагаются для показа в списке установленных приложений и поэтому не имеют индивидуального значка (в этом случае Uninstaller64 отображает собственный стандартный значок в виде коробки и CD-диска).
  </li>
  <li><b>Отображать заплатки Windows</b><br />
    Этой опцией вы можете включать/выключать отображение установленных обновлений Windows. Точность работы этой функции пока что низкая, а в современных версиях Windows она не работает из-за сменившихся путей в реестре. Доработка запланирована на будущие версии.
  </li>
  <li><b>Подтверждать деинсталляцию</b><br />
    Если эта опция включена, плагин будет запрашивать подтверждение перед запуском деинсталляции. Подавляющее большинство деинсталляторов сами выводят такое подтверждение или позволяют отменить запуск, не выполняя никаких действий, поэтому данную опцию можно оставить выключенной.
  </li>
  <li><b>Подтверждать только для скрытых записей</b><br />
    Если предыдущая опция отключена, вы можете оставить подтверждения только для скрытых записей, чтобы обезопасить себя от случайного запуска деинсталляции такого компонента. Кроме того, скрытые компоненты не должны управляться пользователем, поэтому их деинсталляторы часто работают автоматически, без вывода подтверждений. Настоятельно рекомендуется держать эту опцию включённой.
  </li>
  <li><b>Расположение файла настроек плагина</b><br />
    Плагин может хранить свои настройки в одном из трёх местоположений: собственный каталог, каталог установки Total Commander и каталог, где находится файл конфигурации TC (обычно он называется wincmd.ini). Вы должны выбрать такое местоположение, куда у текущего пользователя есть права на запись, иначе плагин не сможет сохранить свои настройки. Если у вас стандартная установка TC, рекомендуется держать настройки плагина вместе с wincmd.ini. Для портабельной конфигурации, когда wincmd.ini находится в каталоге установки TC, удобнее хранить файл настроек вместе с плагином, чтобы не засорять корневой каталог.
  </li>
  <li><b>Язык</b><br />
    Здесь вы можете выбрать язык интерфейса плагина. Обратите внимание, что эта опция влияет только на перевод диалогов и содержимого HTML-файла с данными о ключах реестра. Имена встроенных информационных полей переводятся самим Total Commander автоматически, в соответствии с выбранным в нём языком интерфейса (если, конечно, соответствующая секция присутствует в файле <code>Uninstaller64.lng</code>). 
  </li>
</ul>


<a name="history"></a><h2>История версий</h2>

<h3>Обновление версии 1.0.1 (25.06.2012):</h3>
<ol type="1">
  <li>Добавлен немецкий перевод (TychoBarfy).</li>
  <li>Добавлен испанский перевод (Victor Emmanuel).</li>
  <li>Добавлен датский перевод (Peter Madsen).</li>
  <li>Добавлен французский перевод (Christophe Faure).</li>
  <li>Добавлен венгерский перевод (Bluestar).</li>
</ol>

<h3>Версия 1.0.1 (11.06.2012):</h3>
<ol type="1">
  <li>Исправлено: Плагин не удалял запись из списка после деинсталляции.</li>
  <li>Исправлено: При успешном удалении записи выводилось сообщение об ошибке.</li>
  <li>Исправлено: В некоторых случаях мог отображаться не весь список установленных приложений.</li>
  <li>Добавлено: В порядке эксперимента: Скрытыми также помечаются записи MSI, у которых нет соответствующего дополнительного ключа в реестре.</li>
</ol>

<h3>Версия 1.0.0 (9.06.2012):</h3>
<p>
Это первая публичная версия. Отличия от UnInstaller 1.8.1:
</p>
<ol type="1">
  <li>Наличие 64-битной версии плагина.</li>
  <li>Полная поддержка Юникода.</li>
  <li>Отображение как 32-битных, так и 64-битных записей деинсталляции (независимо от того, какая версия TC используется).</li>
  <li>Улучшен вид HTML-документа с информацией о записи.</li>
  <li>Улучшен выбор значка для отображения в панели TC.</li>
  <li>Опции для подтверждения запуска деинсталляции.</li>
  <li>Более точное отображение даты/времени установки приложения.</li>
  <li>Корректный показ размера установленного приложения при работе в Windows Vista/7.</li>
  <li>Поддержка фоновых операций.</li>
  <li>Поля данных с основной информацией о записях деинсталляции.</li>
  <li>Возможность выбора местоположения файла настроек.</li>
  <li>При деинсталляции программ и удалении записей плагин не меняет индексы-расширения остальных записей, поэтому удаление нескольких приложений подряд не требует обновления списка, а курсор в панели TC не прыгает каждый раз в начало.</li>
  <li>При удалении записи из реестра удаляются также вспомогательные ключи, а не только основной.</li>
  <li>Диалог свойств записи автоматически становится нередактируемым, если нет доступа на модификацию данных для соответствующего ключа.</li>
  <li>[Не реализовано] В HTML-файле с информацией не выводятся расширенные сведения об обновлениях Windows.</li>
</ol>

</body>
</html>
