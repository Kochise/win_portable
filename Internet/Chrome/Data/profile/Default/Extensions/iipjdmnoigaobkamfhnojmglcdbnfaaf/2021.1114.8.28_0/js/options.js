var __rest=this&&this.__rest||function(s,e){var t={};for(var p in s)Object.prototype.hasOwnProperty.call(s,p)&&e.indexOf(p)<0&&(t[p]=s[p]);if(null!=s&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(p=Object.getOwnPropertySymbols(s);i<p.length;i++)e.indexOf(p[i])<0&&Object.prototype.propertyIsEnumerable.call(s,p[i])&&(t[p[i]]=s[p[i]])}return t};import Premium from"./optionsPremium.js";import"./optionsCore.js";!function(){let sections=[];function populateAumList(){const aumSet=Settings.advancedUrlMatchingSet;let aumItemsHtml;aumItemsHtml=0===Object.keys(aumSet).length?`\n                <div class="row_wrapper">\n                    <span class="aum_empty_row">\n                        ${chrome.i18n.getMessage("options_aum_list_empty_view")}\n                    </span>\n                </div>\n            `:Object.keys(aumSet).sort(((a,b)=>aumSet[a].order-aumSet[b].order)).map((k=>{return`\n            <div class="row_wrapper" data-key="${(item=aumSet[k]).key}">\n                <span class="website_name_span" title="${item.url}">${item.url}</span>\n                <span class="faux_checkbox aum_ignore_hash" data-checked="${item.ignoreHash}" data-key="${item.key}">&nbsp;</span>\n                <span class="faux_checkbox aum_ignore_query" data-checked="${item.ignoreQuery}" data-key="${item.key}">&nbsp;</span>\n                <span class="aum_remove_site" title="${titleAumRemoveSite}" data-key="${item.key}">&nbsp;</span>\n            </div>\n        `;var item})).join("\n"),$("#aum_items_container").text("").append(aumItemsHtml)}$((async()=>{await Settings.init(),await Premium.fetchPremiumState(),await async function(){markSidebarItemSelected(location.hash);const lSt=await localSt.getObject({closedDuplicates:DefaultSettings.CLOSED_DUPLICATES,acsInstalled:!1,acsBannerViews:0});$("#statsLink")[lSt.closedDuplicates.length>MIN_SHOW_STATS_PAGE?"show":"hide"](),lSt.acsInstalled||lSt.acsBannerViews>5?$("#acsBanner").hide():localSt.set({acsBannerViews:lSt.acsBannerViews+1});$("#allowDuplicatesAcrossWindows").prop("checked",Settings.allowDuplicatesAcrossWindows),$("#ignoreHash").prop("checked",Settings.ignoreHash),$("#ignoreQuery").prop("checked",Settings.ignoreQuery),$("#showCount").prop("checked",Settings.showCount),$("#searchAllWindows").prop("checked",Settings.searchAllWindows),$("#floatingSearchWindow").prop("checked",Settings.floatingSearchWindow),$(`input[name='cfWindowTheme'][value='${Settings.cfWindowTheme}']`).prop("checked",!0),$(`input[name='copyUrlsFormat'][value='${Settings.copyUrlsFormat}']`).prop("checked",!0),$("#refreshOriginal").prop("checked",Settings.refreshOriginal),$("#linkMarkers").prop("checked",Settings.linkMarkers),$("#closeDuplicateOriginator").prop("checked",Settings.closeDuplicateOriginator),$("#startState").val(Settings.startState),$("#moveOriginalTab").val(Settings.moveOriginalTab),$("#tab_count_limit_enabled").prop("checked",Settings.tabCountLimitEnabled),$("#tab_count_limit").val(Settings.tabCountLimit),$(`input[name='tab_limit_style'][value='${Settings.tabCountLimitStyle}']`).prop("checked",!0),setupForTabCountLimitEnabled(Settings.tabCountLimitEnabled),$(`input[name='notifyBackgroudDuplicatesClosed'][value='${Settings.notifyBackgroudDuplicatesClosed}']`).prop("checked",!0),$(`input[name='notifyOthers'][value='${Settings.notifyOthers}']`).prop("checked",!0),$(`input[name='notifyPreviousDuplicates'][value='${Settings.notifyPreviousDuplicates}']`).prop("checked",!0),$(`input[name='notifyWeeklyStats'][value='${Settings.notifyWeeklyStats}']`).prop("checked",!0),$(`input[name='inPageNotificationTheme'][value='${Settings.inPageNotificationTheme}']`).prop("checked",!0),Settings.notifyBackgroudDuplicatesClosed==NotificationStyle.IN_PAGE||Settings.notifyOthers==NotificationStyle.IN_PAGE||Settings.notifyPreviousDuplicates==NotificationStyle.IN_PAGE?$("#in_page_notification_settings_div").show():$("#in_page_notification_settings_div").hide();$("#browserAction").val(Settings.browserAction),Settings.browserAction===DefaultSettings.BROWSER_ACTION?$("#_execute_browser_action_command_li").show():$("#_execute_browser_action_command_li").hide();Settings.showContextMenu.split(",").forEach((item=>$(`.showContextCheckbox[value="${item}"]`).prop("checked",!0))),$("#list_control_mode").val(Settings.listControlMode),setupListControlModelBlock(Settings.listControlMode),Settings.allowList.length>0&&loadAllowList();Settings.blockList.length>0&&loadBlockList();const isGrandfathered=(await Settings.get(GRANDFATHERED_DOMAIN_BLOCKLIST_USERS))[GRANDFATHERED_DOMAIN_BLOCKLIST_USERS],isDomainBlocklistAllowed=Premium.isSupporter||isGrandfathered,isDomainBlocklistEnabled=isDomainBlocklistAllowed&&Settings.isDomainBlocklistEnabled;$("#isDomainBlocklistEnabled").prop("disabled",!isDomainBlocklistAllowed).prop("checked",isDomainBlocklistEnabled),setDomainBlocklistVisibility(isDomainBlocklistEnabled),isDomainBlocklistEnabled&&Settings.domainBlocklist.length>0&&loadDomainBlocklist();Premium.isSupporter?populateAumList():$("div#aum_items_container, form#aum_add_form").prop("disabled",!0);Premium.setupPurchaseSection(),$("div.cx-edit-help-content").each(((i,el)=>{el.innerHTML=chrome.i18n.getMessage(el.id)})),positionHelps();const{updateNotesIndicator:updateNotesIndicator}=await ls.get({updateNotesIndicator:!1});updateNotesIndicator&&$("#updateNotesLink").addClass("haveNotes")}(),await async function(){const commands=await new Promise((resolve=>chrome.commands.getAll(resolve))),commandActions=Premium.isSupporter?Settings.keyboardCommandActions:DefaultSettings.KEYBOARD_COMMAND_ACTIONS,noKeysText=chrome.i18n.getMessage("options_keyboard_shortcuts_keys_none"),executeBrowserActionCommand=commands.find((c=>"_execute_browser_action"===c.name));executeBrowserActionCommand&&($("#kbd_cmd_browser_action .command_keys").text(executeBrowserActionCommand.shortcut||noKeysText),updateBrowserActionKeyboardShortcutText());commands.filter((c=>"_execute_browser_action"!==c.name)).forEach(((command,i)=>{$(`li#kbd_cmd_item_${i+1} .command_keys`).text(command.shortcut||noKeysText),$(`select#${command.name}`).val(commandActions[command.name]);const commandActionText=$(`select#${command.name} option:selected`).text();Premium.isSupporter?$(`li#kbd_cmd_item_${i+1} span.command_action`).hide():($(`select#${command.name}`).hide(),$(`li#kbd_cmd_item_${i+1} span.command_action`).text(commandActionText).show())})),updateAllowListKeyboardShortcutTexts(Settings.listControlMode)}(),$("body").on("click",".buyButton",Premium.executePurchase),$("div.cx-edit-help-content").hover((e=>$(e.currentTarget).css("display","inherit")),(e=>$(e.currentTarget).css("display","none"))),$("section").hover((e=>$(`#${e.currentTarget.id}Help`).css("visibility","visible")),(e=>$(`#${e.currentTarget.id}Help`).css("visibility","hidden"))),$("section *").focusin((e=>$(`#${$(e.currentTarget).parents("section").attr("id")}Help`).css("visibility","visible"))),$("section *").focusout((e=>$(`#${$(e.currentTarget).parents("section").attr("id")}Help`).css("visibility","hidden"))),$(document).resize(positionHelps),$("body").on("click","a.external_link, a.internal_link",(e=>e.currentTarget.id!=ACTION_OPEN_CONFIGURECOMMANDS||(chrome.tabs.create({url:"chrome://extensions/shortcuts"}),!1))),$("#sidebar_nav li").on("click",(e=>{$("#sidebar_nav li").removeClass("selected"),$(e.currentTarget).addClass("selected")})),window.onhashchange=()=>markSidebarItemSelected(location.hash),$("#list_control_mode").on("change",(e=>{const newValue=e.currentTarget.value;Settings.listControlMode=newValue,setupListControlModelBlock(newValue)})),$("#allowListAddForm").on("submit",addToAllowList),$("#allowListRemoveForm").on("submit",removeFromAllowList),$("#blockListAddForm").on("submit",addToBlockList),$("#blockListRemoveForm").on("submit",removeFromBlockList),$("#domainBlocklistAddForm").on("submit",addToDomainBlocklist),$("#domainBlocklistRemoveForm").on("submit",removeFromDomainBlocklist),$("#isDomainBlocklistEnabled").change((async e=>{if(!e.currentTarget.checked)return Settings.isDomainBlocklistEnabled=!1,void setDomainBlocklistVisibility(!1);const isGrandfathered=(await Settings.get(GRANDFATHERED_DOMAIN_BLOCKLIST_USERS))[GRANDFATHERED_DOMAIN_BLOCKLIST_USERS];Premium.isSupporter||isGrandfathered?(Settings.isDomainBlocklistEnabled=!0,setDomainBlocklistVisibility(!0),Settings.domainBlocklist.length>0&&loadDomainBlocklist()):$("#isDomainBlocklistEnabled").prop("checked",!1)})),$("#startState").change((e=>Settings.startState=e.currentTarget.value)),$(".showContextCheckbox").change((()=>{const contextMenuArr=[];$(".showContextCheckbox:checked").each(((i,e)=>{contextMenuArr.push(e.value)})),Settings.showContextMenu=contextMenuArr.join(",")})),$("#browserAction").change((e=>{Settings.browserAction=e.currentTarget.value,Settings.browserAction===DefaultSettings.BROWSER_ACTION?$("#_execute_browser_action_command_li").show():$("#_execute_browser_action_command_li").hide(),updateBrowserActionKeyboardShortcutText()})),$("#ignoreHash").change((e=>Settings.ignoreHash=e.currentTarget.checked)),$("#ignoreQuery").change((e=>Settings.ignoreQuery=e.currentTarget.checked)),$("#showCount").change((e=>Settings.showCount=e.currentTarget.checked)),$("#searchAllWindows").change((e=>Settings.searchAllWindows=e.currentTarget.checked)),$("#floatingSearchWindow").change((e=>Settings.floatingSearchWindow=e.currentTarget.checked)),$("#allowDuplicatesAcrossWindows").change((e=>Settings.allowDuplicatesAcrossWindows=e.currentTarget.checked)),$("#linkMarkers").change((e=>Settings.linkMarkers=e.currentTarget.checked)),$("#closeDuplicateOriginator").change((e=>Settings.closeDuplicateOriginator=e.currentTarget.checked)),$("select.command_action").change(onKeyboardActionChanged),$(".notifyType").on("click",(e=>{const name=e.currentTarget.name,value=e.currentTarget.value;Settings[name]=value,Settings.notifyBackgroudDuplicatesClosed==NotificationStyle.IN_PAGE||Settings.notifyOthers==NotificationStyle.IN_PAGE||Settings.notifyPreviousDuplicates==NotificationStyle.IN_PAGE?$("#in_page_notification_settings_div").show():$("#in_page_notification_settings_div").hide()})),$("input[name='inPageNotificationTheme']").on("click",(e=>Settings.inPageNotificationTheme=e.currentTarget.value)),$("input[name='cfWindowTheme]'").on("click",(e=>Settings.cfWindowTheme=e.currentTarget.value)),$("input[name='copyUrlsFormat]'").on("click",(e=>Settings.copyUrlsFormat=e.currentTarget.value)),$("#refreshOriginal").change((e=>Settings.refreshOriginal=e.currentTarget.checked)),$("#moveOriginalTab").change((e=>Settings.moveOriginalTab=e.currentTarget.value)),$("#exportSettings").on("click",(()=>{const fileName=`ClutterFree_Settings_${(new Date).toISOString().replace(/^(.{10})T(.{8}).*/i,"$1_$2").replace(/\-|\:/g,"")}.txt`,blob=new Blob([Settings.export()],{type:"text/csv"}),elem=window.document.createElement("a");return elem.href=window.URL.createObjectURL(blob),elem.download=fileName,document.body.appendChild(elem),elem.click(),document.body.removeChild(elem),!1})),$("#importSettings").on("change",(e=>{const input=e.target;if(!input.files||input.files.length<1)return void showImportStatus({success:!1,message:"No file selected."});$("#importStatus").text("Importing").addClass("animateDots showStatus");const reader=new FileReader;return reader.onload=async()=>{const text=reader.result;if(!text)return void showImportStatus({success:!1});const successful=await Settings.import(text);showImportStatus({success:!!successful,onClose:()=>successful&&window.location.reload()})},reader.readAsText(input.files[0]),!1})),$("body").on("click","span.aum_remove_site",(e=>{const itemKey=e.currentTarget.dataset.key,_a=Settings.advancedUrlMatchingSet,_b=itemKey,updatedSet=(_a[_b],__rest(_a,["symbol"==typeof _b?_b:_b+""]));Settings.advancedUrlMatchingSet=updatedSet,$(`.row_wrapper[data-key='${itemKey}'`).fadeOut("fast",(()=>{$(`.row_wrapper[data-key='${itemKey}'`).remove()}))})),$("body").on("click","span.aum_ignore_hash",(e=>{const itemKey=e.currentTarget.dataset.key,currentSet=Settings.advancedUrlMatchingSet,aumItem=currentSet[itemKey];if(!aumItem)return;aumItem.ignoreHash=!aumItem.ignoreHash;const updatedSet=Object.assign({},currentSet,{[aumItem.key]:aumItem});Settings.advancedUrlMatchingSet=updatedSet,populateAumList()})),$("body").on("click","span.aum_ignore_query",(e=>{const itemKey=e.currentTarget.dataset.key,currentSet=Settings.advancedUrlMatchingSet,aumItem=currentSet[itemKey];if(!aumItem)return;aumItem.ignoreQuery=!aumItem.ignoreQuery;const updatedSet=Object.assign({},currentSet,{[aumItem.key]:aumItem});Settings.advancedUrlMatchingSet=updatedSet,populateAumList()})),$("form#aum_add_form").on("submit",(e=>{e.preventDefault();const url=document.querySelector("input#aum_add_url").value.trim();if(!url)return;const cleanedUrl=Utils.cleanUrl(url,{ignoreHash:!0,ignoreQuery:!0,removeProtocol:!0}),currentSet=Settings.advancedUrlMatchingSet,itemKey=Utils.simpleChecksum(cleanedUrl);if(currentSet[itemKey])return $("#add_to_aum_error").fadeIn().delay(DEFAULT_SNACKBAR_TIMEOUT).fadeOut(),void showSnackbar({message:chrome.i18n.getMessage("toast_aum_url_already_in_set")});const ignoreHash=document.querySelector("input#aum_add_ignore_hash").checked,ignoreQuery=document.querySelector("input#aum_add_ignore_query").checked;if(!ignoreHash&&!ignoreQuery)return $("#add_to_aum_error").fadeIn().delay(DEFAULT_SNACKBAR_TIMEOUT).fadeOut(),void showSnackbar({message:chrome.i18n.getMessage("toast_aum_no_property_checked")});const orders=Object.keys(currentSet).map((k=>currentSet[k].order)).sort(),item={key:itemKey,url:cleanedUrl,ignoreHash:ignoreHash,ignoreQuery:ignoreQuery,order:orders.length>0?orders[0]-1:Number.MAX_SAFE_INTEGER},updatedSet=Object.assign({},currentSet,{[itemKey]:item});Settings.advancedUrlMatchingSet=updatedSet,showSnackbar({message:chrome.i18n.getMessage("toast_aum_entry_saved")}),populateAumList(),document.querySelector("input#aum_add_url").value="",document.querySelector("input#aum_add_ignore_hash").checked=!0,document.querySelector("input#aum_add_ignore_query").checked=!0})),$("#tab_count_limit_enabled").on("change",(e=>{const enableTabCountLimit=e.currentTarget.checked;Settings.tabCountLimitEnabled=enableTabCountLimit,setupForTabCountLimitEnabled(enableTabCountLimit)})),$("#tab_count_limit").on("change input",(e=>{const element=e.currentTarget,tabCountLimit=""!=element.value?parseInt(element.value):0;var value;0!=tabCountLimit&&(value=tabCountLimit,tabCountLimitTimeout&&clearTimeout(tabCountLimitTimeout),tabCountLimitTimeout=setTimeout((value=>{tabCountLimitTimeout=void 0,Settings.tabCountLimit=value,showTabCountMessage(),$("#tab_count_limit_saved").clearQueue().fadeIn().delay(2e3).fadeOut()}),1e3,value))})),$("input[name='tab_limit_style'").on("click",(e=>Settings.tabCountLimitStyle=e.currentTarget.value)),$("#activate_reward_code").on("click",Premium.activateRewardCode),$("#reward_code").on("input change",(()=>{$("#reward_code_input_status").text("").removeClass(),$("#reward_code").removeClass()})),$("#acs_banner_link").on("click",(()=>$("#acsBanner").hide())),$("body").on("click","#open_customer_portal",Premium.openCustomerPortal),$("#button_find_sub").on("click",Premium.findExistingSubs),$("div#mask").fadeOut(1e3),getSections(),window.addEventListener("resize",getSections),window.addEventListener("scroll",scrollUpdateThrottled)}));const titleAumRemoveSite=chrome.i18n.getMessage("options_aum_remove_site_tooltip");function showImportStatus(params){$("#importStatus").text(params.message?params.message:params.success?"Import succeeded.":"Import failed.").removeClass("animateDots").addClass("showStatus "+(params.success?"statusSuccess":"statusFail")),setTimeout((()=>{$("#importStatus").text("").removeClass("showStatus statusSuccess statusFail"),params.onClose&&params.onClose()}),2e3)}function markSidebarItemSelected(item){const jqEl=$("#sidebar_nav li").has(`a[href="${item}"]`);jqEl.length>0&&($("#sidebar_nav li").removeClass("selected"),jqEl.addClass("selected"))}function updateBrowserActionKeyboardShortcutText(){$("#kbd_cmd_browser_action span.command_action").text($("#browserAction option:selected").text())}function updateAllowListKeyboardShortcutTexts(listControlMode){const allowListTabText=chrome.i18n.getMessage(listControlMode===ListControlMode.ALLOW_LIST?"options_keyboard_shortcuts_item_allow_list":"options_keyboard_shortcuts_item_block_list"),allowListDomainText=chrome.i18n.getMessage(listControlMode===ListControlMode.ALLOW_LIST?"options_keyboard_shortcuts_item_allow_list_domain":"options_keyboard_shortcuts_item_block_list_domain");if($(`select.command_action option[value='${KeyboardCommands.ALLOW_LIST}']`).each(((_i,e)=>{e.innerHTML=allowListTabText})),$(`select.command_action option[value='${KeyboardCommands.ALLOW_LIST_DOMAIN}']`).each(((_i,e)=>{e.innerHTML=allowListDomainText})),!Premium.isSupporter){const keyboardCommandActions=DefaultSettings.KEYBOARD_COMMAND_ACTIONS,allowStateTabIndex=Object.keys(keyboardCommandActions).findIndex((k=>keyboardCommandActions[k]===KeyboardCommands.ALLOW_LIST)),allowStateDomainIndex=Object.keys(keyboardCommandActions).findIndex((k=>keyboardCommandActions[k]===KeyboardCommands.ALLOW_LIST_DOMAIN));allowStateTabIndex>-1&&$(`li#kbd_cmd_item_${allowStateTabIndex+1} span.command_action`).html(allowListTabText),allowStateDomainIndex>-1&&$(`li#kbd_cmd_item_${allowStateDomainIndex+1} span.command_action`).html(allowListDomainText)}}function onKeyboardActionChanged(e){if(!Premium.isSupporter)return;const keyId=e.currentTarget.id,keyValue=e.currentTarget.value,keyboardCommandActions=Settings.keyboardCommandActions;keyboardCommandActions[keyId]=keyValue,Settings.keyboardCommandActions=keyboardCommandActions}function positionHelps(){$("section").each(((i,el)=>{$(`#${el.id}Help`).css({top:$(el).position().top+30})}))}function loadAllowList(){const allowListOptions=Settings.allowList.map(((allowListItem,i)=>`<option value="${i}">${allowListItem}</option>`)).join("\n");$("#allowListSelect").text("").append(allowListOptions)}function addToAllowList(){let newAllowListURL=$("#allowListInput").val().toString().trim();if(!newAllowListURL)return!1;newAllowListURL=Utils.cleanTrailingSlash(newAllowListURL);const oldAllowList=Settings.allowList,domainBlocklist=Settings.domainBlocklist,domain=Utils.getDomainFromUrl(newAllowListURL);if(domain&&domainBlocklist.includes(domain)){if(Settings.isDomainBlocklistEnabled)return $("#addToAllowListError").fadeIn().delay(DEFAULT_SNACKBAR_TIMEOUT).fadeOut(),showSnackbar({message:chrome.i18n.getMessage("toast_domain_in_allow_list_and_domain_block_list")}),!1;const index=domainBlocklist.indexOf(domain);domainBlocklist.splice(index,1),Settings.domainBlocklist=domainBlocklist,loadDomainBlocklist()}return oldAllowList.includes(newAllowListURL)||(oldAllowList.push(newAllowListURL),Settings.allowList=oldAllowList,loadAllowList()),$("#allowListInput").val(""),!1}function removeFromAllowList(){if($("#allowListSelect option:selected").length<=0)return!1;const removedArray=[],oldAllowList=Settings.allowList;return $("#allowListSelect option:selected").each(((i,e)=>{removedArray.push(oldAllowList[e.value])})),Settings.allowList=oldAllowList.filter((allowListUrl=>!removedArray.includes(allowListUrl))),loadAllowList(),!1}function loadBlockList(){const blockListOptions=Settings.blockList.map(((blockListItem,i)=>`<option value="${i}">${blockListItem}</option>`)).join("\n");$("#blockListSelect").text("").append(blockListOptions)}function addToBlockList(){let newBlockListURL=$("#blockListInput").val().toString().trim();if(!newBlockListURL)return!1;newBlockListURL=Utils.cleanTrailingSlash(newBlockListURL);let oldBlockList=Settings.blockList;return oldBlockList.includes(newBlockListURL)||(oldBlockList=[].concat(oldBlockList,[newBlockListURL]),Settings.blockList=oldBlockList,loadBlockList()),$("#blockListInput").val(""),!1}function removeFromBlockList(){if($("#blockListSelect option:selected").length<=0)return!1;const removedArray=[],oldBlockList=Settings.blockList;return $("#blockListSelect option:selected").each(((i,e)=>{removedArray.push(oldBlockList[e.value])})),Settings.blockList=oldBlockList.filter((blockListUrl=>!removedArray.includes(blockListUrl))),loadBlockList(),!1}function loadDomainBlocklist(){const domainBlockListOptions=Settings.domainBlocklist.map(((domainBlocklistItem,i)=>`<option value="${i}">${domainBlocklistItem}</option>`)).join("\n");$("#domainBlocklistSelect").text("").append(domainBlockListOptions)}function addToDomainBlocklist(){const url=$("#domainBlocklistInput").val().toString().trim(),domain=Utils.getDomainFromUrl(url);if(!domain)return!1;if(Settings.allowList.some((allowListedUrl=>Utils.getDomainFromUrl(allowListedUrl)===domain)))return $("#addToDomainBlocklistError").fadeIn().delay(DEFAULT_SNACKBAR_TIMEOUT).fadeOut(),showSnackbar({message:chrome.i18n.getMessage("toast_domain_in_allow_list_and_domain_block_list")}),!1;const oldDomainBlocklist=Settings.domainBlocklist;return oldDomainBlocklist.includes(domain)||(oldDomainBlocklist.push(domain),Settings.domainBlocklist=oldDomainBlocklist,loadDomainBlocklist()),$("#domainBlocklistInput").val(""),!1}function removeFromDomainBlocklist(){if($("#domainBlocklistSelect option:selected").length<=0)return!1;const removedArr=[],oldDomainBlocklist=Settings.domainBlocklist;return $("#domainBlocklistSelect option:selected").each(((i,e)=>{removedArr.push(oldDomainBlocklist[e.value])})),Settings.domainBlocklist=oldDomainBlocklist.filter((domainBlocklistUrl=>!removedArr.includes(domainBlocklistUrl))),loadDomainBlocklist(),!1}function setDomainBlocklistVisibility(isEnabled){$("#domainBlocklistDiv")[isEnabled?"show":"hide"](),$("#domainBlockListExplanationShort")[isEnabled?"hide":"show"]()}function setupListControlModelBlock(listControlMode){let contextMenuControlListAddTabTextKey="options_context_menu_item_allow_list",contextMenuControlListAddDomainTextKey="options_context_menu_item_allow_list_domain",browserActionControlListTabTextKey="options_browser_action_item_allow_list",browserActionControlListDomainTextKey="options_browser_action_item_allow_list_domain",keyboardLabelControlListAddTabKey="options_keyboard_shortcuts_item_allow_list",keyboardLabelControlListAddDomainKey="options_keyboard_shortcuts_item_allow_list_domain",labelNotificationControlListUpdated="options_notifications_item_allow_list_updated";listControlMode==ListControlMode.BLOCK_LIST?($("#allow_list").hide(),$("#block_list").show(),contextMenuControlListAddTabTextKey="options_context_menu_item_block_list",contextMenuControlListAddDomainTextKey="options_context_menu_item_block_list_domain",browserActionControlListTabTextKey="options_browser_action_item_block_list",browserActionControlListDomainTextKey="options_browser_action_item_block_list_domain",keyboardLabelControlListAddTabKey="options_keyboard_shortcuts_item_block_list",keyboardLabelControlListAddDomainKey="options_keyboard_shortcuts_item_block_list_domain",labelNotificationControlListUpdated="options_notifications_item_block_list_updated"):($("#allow_list").show(),$("#block_list").hide()),$("#contextMenuItemAllowlistSpan").text("").append(chrome.i18n.getMessage(contextMenuControlListAddTabTextKey)),$("#contextMenuItemAllowlistDomainSpan").text("").append(chrome.i18n.getMessage(contextMenuControlListAddDomainTextKey)),$(`select#browserAction option[value='${BrowserAction.ALLOW_LIST}']`).text(chrome.i18n.getMessage(browserActionControlListTabTextKey)),$(`select#browserAction option[value='${BrowserAction.ALLOW_LIST_DOMAIN}']`).text(chrome.i18n.getMessage(browserActionControlListDomainTextKey)),Settings.browserAction!=BrowserAction.ALLOW_LIST&&Settings.browserAction!=BrowserAction.ALLOW_LIST_DOMAIN||updateBrowserActionKeyboardShortcutText(),$("span#allow_list_command_span").text("").append(chrome.i18n.getMessage(keyboardLabelControlListAddTabKey)),$("span#allow_list_domain_command_span").text("").append(chrome.i18n.getMessage(keyboardLabelControlListAddDomainKey)),$("span#label_notification_control_list_updated").text("").append(chrome.i18n.getMessage(labelNotificationControlListUpdated)),updateAllowListKeyboardShortcutTexts(listControlMode)}let tabCountLimitTimeout;function setupForTabCountLimitEnabled(enableTabCountLimit){enableTabCountLimit?($(".tab_count_enabled_dependant").prop("disabled",!1).removeClass("disabled"),showTabCountMessage()):($(".tab_count_enabled_dependant").prop("disabled",!0).addClass("disabled"),$("#tab_count_limit_status_smiley").hide(),$("#tab_count_limit_status").text(""))}async function showTabCountMessage(){const count=await MessageSender.sendMessage({type:MessageType.GET_TAB_COUNT}),tabCountLimit=Settings.tabCountLimit;let countSmileyClass="smiley_success";count>tabCountLimit?countSmileyClass="smiley_error":count>.8*tabCountLimit&&(countSmileyClass="smiley_warn"),$("#tab_count_limit_status").text(chrome.i18n.getMessage("options_advanced_tab_count_limit_status",count+"")).show(),$("#tab_count_limit_status_smiley").removeClass("smiley_success smiley_warn smiley_error").addClass(countSmileyClass).show()}let scrollUpdateTimeout;function scrollUpdateThrottled(){scrollUpdateTimeout&&clearTimeout(scrollUpdateTimeout),scrollUpdateTimeout=setTimeout(scrollUpdate,30)}function scrollUpdate(){if(scrollUpdateTimeout=void 0,sections.length<2)return;const offset=window.pageYOffset,previousSectionIndex=sections.findIndex((s=>s.top>offset));let sectionIndex=0;if(previousSectionIndex>0){const midwayOffset=(sections[previousSectionIndex-1].top+sections[previousSectionIndex].top)/2;sectionIndex=offset>midwayOffset?previousSectionIndex:previousSectionIndex-1}else offset>sections[sections.length-1].top&&(sectionIndex=sections.length-1);const section=sections[sectionIndex];document.querySelectorAll("#sidebar_nav li").forEach((e=>e.classList.remove("selected"))),document.querySelector(`ul#sidebar_nav li[data-section-id='${section.id}']`).classList.add("selected"),history.replaceState("","",`#${section.id}`)}function getSections(){sections=[],document.querySelectorAll("div.settings-sections").forEach((element=>sections.push({id:element.id,top:element.offsetTop}))),sections=sections.filter((k=>!!k)).sort(((a,b)=>a.top-b.top))}function showSnackbar(options){options&&options.message&&""!=options.message&&$("#snackbar").text(options.message).fadeIn().delay(options.delay||DEFAULT_SNACKBAR_TIMEOUT).fadeOut()}}();