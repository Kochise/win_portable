const MessageSender={sendMessage:async function(message,rejectOnError=!1){return new Promise(((resolve,reject)=>{try{chrome.runtime.sendMessage(message,(response=>{chrome.runtime.lastError&&console.debug(chrome.runtime.lastError.message,message),resolve(response)}))}catch(e){if(rejectOnError)return void reject(e);resolve(e)}}))},sendMessageToExtension:async function(extensionId,message,rejectOnError=!1){return new Promise(((resolve,reject)=>{try{chrome.runtime.sendMessage(extensionId,message,(response=>{chrome.runtime.lastError&&console.debug(chrome.runtime.lastError.message,extensionId,message),resolve(response)}))}catch(e){if(rejectOnError)return void reject(e);resolve(e)}}))}},Suspender=function(){const UN_SUSPENDABLE_URL=/^chrome(\-extension)?:\/\//,TGS_EXT_IDS=["ahmkjjgdligadogjedmnogbpbcpofeeo","jaekigmcljkkalnicnjoafgfjoefkpeg","noogafoofpebimajpfpamcfhoaifemoa"];let tgsExtId="x______________________________x",suspenderRegex=RegExp(`chrome\\-extension\\:\\/\\/${tgsExtId}\\/suspended.html(.*?)\\#(?:ttl=.+?\\&)?uri=(.+?)$`);async function checkIsExtInstalled(extId){await MessageSender.sendMessageToExtension(extId,{},!1);return!chrome.runtime.lastError}async function getInstalledExtId(){for(const extId of TGS_EXT_IDS){if(await checkIsExtInstalled(extId))return console.debug("Suspender extension id",extId),extId}return console.debug("No suspender extension installed"),null}function isSuspended(url){return suspenderRegex.test(url)}return async function(){const extId=await getInstalledExtId();null!=extId&&(tgsExtId=extId,function(extId){suspenderRegex=RegExp(`chrome\\-extension\\:\\/\\/${extId}\\/suspended.html(.*?)\\#(?:ttl=.+?\\&)?uri=(.+?)$`)}(extId))}(),{isSuspended:isSuspended,cleanSuspended:function(url){return isSuspended(url)?url.replace(suspenderRegex,"$2$1"):url},sendMessage:async function(message={},rejectOnError=!1){return MessageSender.sendMessageToExtension(tgsExtId,message,rejectOnError)},isSuspendableUrl:function(url){return!UN_SUSPENDABLE_URL.test(url)},getInstalledExtId:getInstalledExtId}}(),Utils=function(){const REGEX_REMOVE_DEDUP=/(?:&|\?)cf_lbyyhhwhyjj5l3rs65cb3w=(?:[a-z0-9]+)/i,TRAILING_SLASH_REGEX=/^(\S+?)(\/)((?:(?:#|\?)\S+)?$)/,REMOVE_HASH_REGEX=/\/?\#.*?$/,REMOVE_QUERY_REGEX=/(\/?)\?.*?($|#)/,EXTRACT_DOMAIN_REGEX=/^(([^:/?#]+):)?(\/\/)?((?:www\.)?([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?/i;function cleanTrailingSlash(url){return url.replace(TRAILING_SLASH_REGEX,"$1$3")}function removeHash(url){return url.replace(REMOVE_HASH_REGEX,"")}function removeQuery(url){return url.replace(REMOVE_QUERY_REGEX,"")}const REGEX_PROTOCOL=/^([a-z][a-z0-9+.-]+:\/\/)/i;function url_parameter(url,param,value){if(!param||!url)return url;const PARAM_EXISTS_REGEX=new RegExp(`(\\?|\\&)${param}=.*?(?=(&|$))`,"i");let return_url=url;const parts=url.toString().split("#"),hash=parts.slice(1).join("#").replace(PARAM_EXISTS_REGEX,"$1").replace(/(\?|\&)$/,"");return url=parts[0],PARAM_EXISTS_REGEX.test(url)?return_url=value?url.replace(PARAM_EXISTS_REGEX,`$1${param}=${value}`):url.replace(PARAM_EXISTS_REGEX,"$1").replace(/(\?|\&)$/,""):/\?.+$/.test(url)&&value?return_url=`${url}&${param}=${value}`:value&&(return_url=`${url}?${param}=${value}`),/(\?|\&)$/.test(return_url)&&return_url.substr(0,return_url.length-1),hash&&(return_url+=`#${hash}`),return_url}function removeDedupFromURL(url){return url.replace(REGEX_REMOVE_DEDUP,"")}function getRandomString(){return Math.random().toString(36).slice(2)+Math.random().toString(36).slice(2)}let emailAddress="";async function getEmailAddress(){return emailAddress||new Promise((resolve=>{try{chrome.identity.getProfileUserInfo({accountStatus:chrome.identity.AccountStatus.ANY},(userInfo=>chrome.runtime.lastError?(console.debug(`Error: ${chrome.runtime.lastError.message}.`),void resolve("")):userInfo.email?(emailAddress=userInfo.email,void resolve(emailAddress)):(console.debug("Error: No email address."),void resolve(""))))}catch(e){console.debug(`Exception: ${e}`),resolve("")}}))}return{getDomainFromUrl:function(url){if(url)return url=Suspender.cleanSuspended(url),EXTRACT_DOMAIN_REGEX.test(url)?url.match(EXTRACT_DOMAIN_REGEX)[5]:void 0},addDedupToURL:function(url){if(!url)return url;if(!Suspender.isSuspended(url))return url_parameter(removeDedupFromURL(url),"cf_lbyyhhwhyjj5l3rs65cb3w",getRandomString());const unsuspendedUrl=Suspender.cleanSuspended(url),unsuspendedWithDupe=url_parameter(removeDedupFromURL(unsuspendedUrl),"cf_lbyyhhwhyjj5l3rs65cb3w",getRandomString());return url.replace(unsuspendedUrl,unsuspendedWithDupe)},removeDedupFromURL:removeDedupFromURL,hasDedupParam:function(url){return function(url,param){return!!url&&(!param||new RegExp(`(\\?|\\&)${param}=.*?(?=(&|$))`,"i").test(url))}(url,"cf_lbyyhhwhyjj5l3rs65cb3w")},arrayToObject:function(arr,key){return arr.reduce(((acc,item)=>(item[key]&&(acc[item[key]]=item),acc)),{})},makeXMLSafe:function(text){return text?text.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):text},escapeRegex:function(text){return text.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")},getVersionNumberFromString:function(versionString="",asString=!1){const vArr=versionString.split(".");if(vArr.length<4)return Number.MAX_SAFE_INTEGER;const vArr3=parseInt(vArr[3]),version=parseFloat(`${vArr[2]}.${vArr3<10?`0${vArr3}`:vArr[3]}`);return asString?Number.isInteger(version)?`${version}.0`:Number.isInteger(10*version)?`${version}0`:`${version}`:version},getRandomString:getRandomString,serialize:function serialize(obj){if(Array.isArray(obj))return JSON.stringify(obj.map((i=>serialize(i))));if("object"==typeof obj&&null!==obj)return Object.keys(obj).sort().map((k=>`${k}:${serialize(obj[k])}`)).join("|");throw new Error("argument is not an object or array")},simpleChecksum:function(s){let chk=305419896;const len=s.length;for(let i=0;i<len;i++)chk+=s.charCodeAt(i)*(i+1);return(4294967295&chk).toString(16)},cleanTrailingSlash:cleanTrailingSlash,cleanUrl:function(url,options={}){return options.removeSuspender=void 0===options.removeSuspender||options.removeSuspender,options.deDuplicate=void 0===options.deDuplicate||options.deDuplicate,options.deDuplicate&&(url=removeDedupFromURL(url)),options.removeSuspender&&(url=Suspender.cleanSuspended(url)),!0===options.ignoreHash&&(url=removeHash(url)),!0===options.ignoreQuery&&(url=removeQuery(url)),options.lowerCase&&(url=url.toLowerCase()),options.addHttps&&(url=function(url){return REGEX_PROTOCOL.test(url)?url:`https://${url.replace(/^\/+/,"")}`}(url)),options.removeProtocol&&(url=function(url){return url.replace(REGEX_PROTOCOL,"")}(url)),cleanTrailingSlash(url)},removeHash:removeHash,removeQuery:removeQuery,parseQuery:function(query){null==query&&(query="");const result={};return query.split("&").forEach((item=>{const itemParts=item.split("=");result[itemParts[0]]=itemParts[1]})),result},randomDate:function(start,end,startHour,endHour){const date=new Date(+start+Math.random()*(end-start)),hour=startHour+Math.random()*(endHour-startHour)|0;return date.setHours(hour),date.getDate()<=Date.now()&&date.setDate(date.getDate()+1),date},arrayMove:function(array,from,to){array.splice(to,0,array.splice(from,1)[0])},getCurrentTab:async function(){const tabs=await new Promise((resolve=>chrome.tabs.query({currentWindow:!0,active:!0,windowType:"normal"},resolve)));return!chrome.runtime.lastError&&tabs&&tabs[0]&&tabs[0].url&&tabs[0].url.trim()?tabs[0]:(console.warn("Couldn't get tab",chrome.runtime.lastError),null)},getEmailAddress:getEmailAddress,getFeedbackUrl:async function(isSupporter){let feedbackUrl;const osVersion=`${window.navigator.userAgent.match(/(Chrome\/\S+)\s/i)[0]||"none found"}__${navigator.platform||"none found"}`,appVersion=chrome.runtime.getManifest().version,userEmail=await getEmailAddress();return isSupporter?(feedbackUrl=`${Urls.SUPPORTER_FEEDBACK}&entry.153422268=${appVersion}&entry.1834685300=${osVersion}`,userEmail&&(feedbackUrl=`${feedbackUrl}&entry.1652780603=${userEmail}`)):(feedbackUrl=`${Urls.FEEDBACK}&entry.153422268=${appVersion}&entry.391219820=${osVersion}`,userEmail&&(feedbackUrl=`${feedbackUrl}&entry.1652780603=${userEmail}`)),feedbackUrl},delay:function(ms){return new Promise((resolve=>setTimeout(resolve,ms)))},lightOrDark:function(element){let r,b,g,hsp,alpha;const a=element.css("background-color");if(a.match(/^rgb/)){const a1=a.match(/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*(\d+(?:\.\d+)?))?\)$/);r=parseInt(a1[1]),g=parseInt(a1[2]),b=parseInt(a1[3]),alpha=parseInt(a1[4]||"1")}else{const a2=+("0x"+a.slice(1).replace(a.length<5&&/./g,"$&$&"));alpha=a.length>7?(255&a2)/255:1,r=255&(a.length>7?a2>>24:a2>>16),g=255&(a.length>7?a2>>16:a2>>8),b=255&(a.length>7?a2>>8:a2)}return r=255*Math.round(alpha*r/255+1*(1-alpha)),g=255*Math.round(alpha*g/255+1*(1-alpha)),b=255*Math.round(alpha*b/255+1*(1-alpha)),hsp=Math.sqrt(r*r*.299+g*g*.587+b*b*.114),hsp>127.5?"light":"dark"}}}();